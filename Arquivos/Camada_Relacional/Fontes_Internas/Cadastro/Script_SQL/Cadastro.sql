--------------------------------------------------------
--  Arquivo criado - TerÃ§a-feira-Junho-07-2022   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for View CAD_RAZAO_SITUACAO_CADASTRAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_RAZAO_SITUACAO_CADASTRAL" ("ID", "CODIGO_RAZAO_SITUACAO") AS 
  (
      SELECT DISTINCT TGE_COD_TIP_TABLA AS ID, 
      TGE_COD_TIP_TABLA AS codigo_razao_situacao
      FROM APL_PAR.TAB_GENERICA@dl_cent  
      WHERE TGE_TIP_TABLA = 12 AND (TGE_COD_TIP_TABLA > 0)
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_TEM_SOCIEDADE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_TEM_SOCIEDADE" ("ID_SOCIEDADE", "ID_EMPRESA", "ID_SOCIO", "TIPO") AS 
  (     
      SELECT ID as ID_sociedade, ID_empresa, TO_CHAR(ID_socio) AS ID_socio, 'FISICA' AS TIPO FROM CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT
      UNION ALL
      SELECT ID as ID_sociedade, ID_empresa, TO_CHAR(ID_socio) AS ID_socio, 'JURIDICA' AS TIPO FROM CAD_SOCIEDADE_COM_HOLDING_MAT
) WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_SOCIOS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_SOCIOS" ("ID", "CPF_CNPJ", "NOME", "PERCENTUAL_PARTICIPACAO", "ID_QUALIFICACAO") AS 
  (
    SELECT TO_CHAR(soc_mat.ID_SOCIO) AS ID, TO_CHAR(pessoa.CPF) AS CPF_CNPJ, pessoa.NOME, PERCENTUAL_PARTICIPACAO, ID_QUALIFICACAO  FROM CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT soc_mat
    INNER JOIN
    CAD_PESSOA_MAT pessoa
    ON
    soc_mat.ID_SOCIO = pessoa.ID 
    UNION ALL 
    SELECT TO_CHAR(soc_jur.ID_SOCIO) AS ID, empresa.CNPJ AS CPF_CNPJ, empresa.RAZAO_SOCIAL AS NOME, PERCENTUAL_PARTICIPACAO, ID_QUALIFICACAO FROM CAD_SOCIEDADE_COM_HOLDING_MAT soc_jur
    INNER JOIN
    CAD_EMPRESA empresa
    ON
    soc_jur.ID_SOCIO = empresa.ID
) WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_PEM
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_PEM" ("ID", "ID_TIPO_REGIME_TRIBUTARIO", "CODIGO_REGIME") AS 
  (
    SELECT DISTINCT ID_contribuinte_geral AS ID, ID_tipo_regime_tributario, CODIGO_REGIME
    FROM CAD_CONTRIBUINTE_GERAL_MAT
    WHERE ID_tipo_regime_tributario = 'PEM'
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_TEM_ESTABELECIMENTO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_TEM_ESTABELECIMENTO" ("ID_EMPRESA", "ID_ESTABELECIMENTO") AS 
  (
    SELECT RGE_RUC AS ID_empresa, 
    geral.RGE_RUC AS ID_estabelecimento
    FROM TAXMAOC.RUC_GENERAL@dl_cent geral
    WHERE RGE_TIP_PERSONA = 2 AND RGE_TIPO_CADASTRO = 1
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_SUBSTITUTO_TRIBUTARIO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_SUBSTITUTO_TRIBUTARIO" ("ID", "ID_TIPO_REGIME_TRIBUTARIO", "CODIGO_REGIME") AS 
  (
    SELECT DISTINCT ID_contribuinte_geral AS ID, ID_tipo_regime_tributario, CODIGO_REGIME
    FROM CAD_CONTRIBUINTE_GERAL_MAT
    WHERE ID_tipo_regime_tributario = 'SUBSTITUTO_TRIBUTARIO'
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_TEM_DEPOSITO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_TEM_DEPOSITO" ("ID_EMPRESA", "ID_ESTABELECIMENTO") AS 
  (
    SELECT RGE_RUC AS ID_empresa, 
    geral.RGE_RUC AS ID_estabelecimento
    FROM TAXMAOC.RUC_ESTABLECIMIENTOS@dl_cent  est, TAXMAOC.RUC_GENERAL@dl_cent geral 
    WHERE geral.RGE_RUC = est.RES_RUC_ESTABLECIMIENTO AND est.RES_TIP_ESTABLECIMIENTO = 3
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_PORTE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_PORTE" ("ID_PORTE") AS 
  (
SELECT  DISTINCT
        CASE  
        WHEN RJU_VAL_CAP_SOCIALES <= 81000 THEN 'MEI'
                    WHEN RJU_VAL_CAP_SOCIALES > 81000 AND RJU_VAL_CAP_SOCIALES <= 3600000 THEN 'MICRO_EMPRESA'
                    WHEN RJU_VAL_CAP_SOCIALES > 360000 AND RJU_VAL_CAP_SOCIALES <= 4800000 THEN 'PEQUENO_PORTE'
                    WHEN RJU_VAL_CAP_SOCIALES > 4800000 AND RJU_VAL_CAP_SOCIALES <= 300000000 THEN 'MEDIO_PORTE'
                    WHEN RJU_VAL_CAP_SOCIALES > 300000000 THEN 'GRANDE_PORTE'
                    WHEN RJU_VAL_CAP_SOCIALES IS NULL THEN 'SEM_PORTE'
                    END AS ID_PORTE
        FROM TAXMAOC.RUC_JURIDICOS@DL_CENT
)
;
--------------------------------------------------------
--  DDL for View CAD_TIPO_REGIME_TRIBUTARIO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_TIPO_REGIME_TRIBUTARIO" ("ID", "CODIGO_TIPO_REGIME") AS 
  (
    SELECT DISTINCT CASE TCO_COD_CONDICION
                    WHEN 0 THEN 'EXTRA_CADASTRO' 
                    WHEN 1 THEN 'CONTRIBUINTE_NORMAL'
                    WHEN 3 THEN 'PEM'
                    WHEN 4 THEN 'SUBSTITUTO_TRIBUTARIO'
                    WHEN 5 THEN 'ISENTO'
                    WHEN 7 THEN 'SIMPLES_NACIONAL'
                    WHEN 8 THEN 'SIMEI'
                    WHEN 9 THEN 'NAO_CONTRIBUINTE'
                END as ID, TCO_COD_CONDICION AS codigo_tipo_regime 
    FROM APL_PAR.TAB_COND_CONTRIBUYENTE@dl_cent 
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_SOCIEDADE_COM_HOLDING
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_SOCIEDADE_COM_HOLDING" ("ID", "ID_QUALIFICACAO", "PERCENTUAL_PARTICIPACAO", "ID_USUARIO", "ID_UNIDADE", "ID_EMPRESA", "ID_SOCIO", "INICIO_PARTICIPACAO", "FIM_PARTICIPACAO", "DATA_ATUALIZACAO") AS 
  (
    SELECT "ID","ID_QUALIFICACAO","PERCENTUAL_PARTICIPACAO","ID_USUARIO","ID_UNIDADE","ID_EMPRESA","ID_SOCIO","INICIO_PARTICIPACAO","FIM_PARTICIPACAO","DATA_ATUALIZACAO" FROM CAD_SOCIEDADE_COM_HOLDING_MAT
    
) WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_PERIODICIDADE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_PERIODICIDADE" ("ID", "CODIGO_PERIODICIDADE") AS 
  (
    SELECT DISTINCT 
    CASE ROB_PERIODICIDAD_OBLIG 
                    WHEN 1 THEN 'ANUAL'
                    WHEN 2 THEN 'MENSAL'
                ELSE 'NAO_DEFINIDO'
                END as ID, 
    ROB_PERIODICIDAD_OBLIG AS codigo_periodicidade 
    FROM TAXMAOC.RUC_OBLIGACIONES@dl_cent 
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_TEM_FILIAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_TEM_FILIAL" ("ID_EMPRESA", "ID_ESTABELECIMENTO") AS 
  (
    SELECT "ID_EMPRESA","ID_ESTABELECIMENTO" FROM CAD_TEM_FILIAL_MAT
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_TEM_SITUACAO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_TEM_SITUACAO" ("ID_OBRIGACAO_LEGAL", "ID_SITUACAO_CADASTRAL") AS 
  (
    SELECT "ID_OBRIGACAO_LEGAL","ID_SITUACAO_CADASTRAL" FROM CAD_TEM_SITUACAO_MAT
)
;
--------------------------------------------------------
--  DDL for View CAD_SOCIEDADE_COM_PESSOA_FISICA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_SOCIEDADE_COM_PESSOA_FISICA" ("ID", "ID_QUALIFICACAO", "PERCENTUAL_PARTICIPACAO", "ID_USUARIO", "ID_UNIDADE", "ID_EMPRESA", "ID_SOCIO", "INICIO_PARTICIPACAO", "FIM_PARTICIPACAO", "DATA_ATUALIZACAO") AS 
  (
    SELECT "ID","ID_QUALIFICACAO","PERCENTUAL_PARTICIPACAO","ID_USUARIO","ID_UNIDADE","ID_EMPRESA","ID_SOCIO","INICIO_PARTICIPACAO","FIM_PARTICIPACAO","DATA_ATUALIZACAO" FROM CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_SIMPLES_NACIONAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_SIMPLES_NACIONAL" ("ID", "ID_TIPO_REGIME_TRIBUTARIO", "CODIGO_REGIME") AS 
  (
    SELECT DISTINCT ID_contribuinte_geral AS ID, ID_tipo_regime_tributario, CODIGO_REGIME
    FROM CAD_CONTRIBUINTE_GERAL_MAT
    WHERE ID_tipo_regime_tributario = 'SIMPLES_NACIONAL'
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_TEM_SITUACAO_CADASTRAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_TEM_SITUACAO_CADASTRAL" ("ID_ESTABELECIMENTO", "CNPJ_CPF", "DATA_SITUACAO_CADASTRAL", "TIPO_SITUACAO", "ID_SITUACAO_CADASTRAL", "INSCRICAO_ESTADUAL") AS 
  (
    SELECT "ID_ESTABELECIMENTO","CNPJ_CPF","DATA_SITUACAO_CADASTRAL","TIPO_SITUACAO","ID_SITUACAO_CADASTRAL","INSCRICAO_ESTADUAL" FROM CAD_TEM_SITUACAO_CADASTRAL_MAT
)
;
--------------------------------------------------------
--  DDL for View CAD_TEM_SITUACAO_FISCAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_TEM_SITUACAO_FISCAL" ("ID_ESTABELECIMENTO", "ID_SITUACAO_FISCAL") AS 
  (
    SELECT INSCRICAO_ESTADUAL AS ID_ESTABELECIMENTO, sf.ID AS ID_SITUACAO_FISCAL FROM "CAD_SITUACAO_FISCAL" sf
    INNER JOIN
    CAD_ESTABELECIMENTO cad
    ON
    cad.INSCRICAO_ESTADUAL = sf.IE
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_REALIZACAO_ATIVIDADE_ECONOMICA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_REALIZACAO_ATIVIDADE_ECONOMICA" ("ID", "ID_ATIVIDADE_ECONOMICA", "INICIO_ATIVIDADE_ECONOMICA", "DATA_MODIFICACAO") AS 
  (
    SELECT "ID","ID_ATIVIDADE_ECONOMICA","INICIO_ATIVIDADE_ECONOMICA","DATA_MODIFICACAO" FROM CAD_REALIZACAO_ATIVIDADE_ECONOMICA_MAT
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_NIVEL_CUMPRIMENTO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_NIVEL_CUMPRIMENTO" ("URI", "CODIGO_NIVEL_CUMPRIMENTO") AS 
  (
    SELECT DISTINCT CASE RGE_NIVELCUMPRIMENTO WHEN 1 THEN 'BOM'
                    WHEN 2 THEN 'REGULAR'
                    WHEN 3 THEN 'MAU'
                END as uri, RGE_NIVELCUMPRIMENTO AS codigo_nivel_cumprimento
    FROM TAXMAOC.RUC_GENERAL@dl_cent geral
    WHERE RGE_NIVELCUMPRIMENTO IS NOT NULL
)
WITH READ ONLY

;
--------------------------------------------------------
--  DDL for View CAD_TEM_REPRESENTANTE_JURIDICO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_TEM_REPRESENTANTE_JURIDICO" ("ID_REPRESENTANTE", "ID_SOCIEDADE", "ID_QUALIFICACAO") AS 
  (
    SELECT "ID_REPRESENTANTE","ID_SOCIEDADE","ID_QUALIFICACAO" FROM CAD_TEM_REPRESENTANTE_JURIDICO_MAT
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_TEM_REPRESENTANTE_FISICO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_TEM_REPRESENTANTE_FISICO" ("ID_REPRESENTANTE", "ID_SOCIEDADE", "ID_QUALIFICACAO") AS 
  (
    SELECT "ID_REPRESENTANTE","ID_SOCIEDADE","ID_QUALIFICACAO" FROM CAD_TEM_REPRESENTANTE_FISICO_MAT
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_SIMEI
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_SIMEI" ("ID", "ID_TIPO_REGIME_TRIBUTARIO", "CODIGO_REGIME") AS 
  (
    SELECT DISTINCT ID_contribuinte_geral AS ID, ID_tipo_regime_tributario, CODIGO_REGIME
    FROM CAD_CONTRIBUINTE_GERAL_MAT
    WHERE ID_tipo_regime_tributario = 'SIMEI'
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_QUALIFICACAO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_QUALIFICACAO" ("ID", "ROTULO", "CODIGO_QUALIFICACAO") AS 
  (
    SELECT REPLACE(TRANSLATE (TGE_NOMBRE_DESCRIPCION,
                  'Å Å½Å¡Å¾Å¸ÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃ¥Ã¡Ã§Ã©Ã­Ã³ÃºÃ Ã¨Ã¬Ã²Ã¹Ã¢ÃªÃ®Ã´Ã»Ã£ÃµÃ«Ã¼Ã¯Ã¶Ã±Ã½Ã¿',
                  'SZszYACEIOUAEIOUAEIOUAOEUIONYaaceiouaeiouaeiouaoeuionyy'),' ','_')
    AS ID, TGE_NOMBRE_DESCRIPCION AS ROTULO, TGE_COD_TIP_TABLA AS codigo_qualificacao 
    FROM APL_PAR.TAB_GENERICA@dl_cent  WHERE TGE_TIP_TABLA = 34
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_PESSOA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_PESSOA" ("ID", "CPF", "INSCRICAO_ESTADUAL", "NOME", "ID_CONTRIBUINTE_GERAL", "ID_TIPO_CONTRIBUICAO", "ID_TIPO_REGIME_TRIBUTARIO") AS 
  (
    SELECT "ID","CPF","INSCRICAO_ESTADUAL","NOME","ID_CONTRIBUINTE_GERAL","ID_TIPO_CONTRIBUICAO","ID_TIPO_REGIME_TRIBUTARIO" FROM CAD_PESSOA_MAT
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_TEM_MATRIZ
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_TEM_MATRIZ" ("ID_EMPRESA", "ID_ESTABELECIMENTO") AS 
  (
    SELECT "ID_EMPRESA","ID_ESTABELECIMENTO" FROM CAD_TEM_MATRIZ_MAT 
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_SITUACAO_CADASTRAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_SITUACAO_CADASTRAL" ("ID", "CODIGO_SITUACAO_CADASTRAL", "TIPO_SITUACAO", "DATA_SITUACAO_CADASTRAL", "CNPJ_CPF", "STATUS_BAIXA") AS 
  (
   SELECT "ID","CODIGO_SITUACAO_CADASTRAL","TIPO_SITUACAO","DATA_SITUACAO_CADASTRAL","CNPJ_CPF","STATUS_BAIXA" FROM CAD_SITUACAO_CADASTRAL_MAT
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_SITUACAO_FISCAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_SITUACAO_FISCAL" ("ID", "SITUACAO", "IE", "CODIGO_SITUACAO_FISCAL", "DATA_SITUACAO_FISCAL") AS 
  (
    SELECT "ID","SITUACAO","IE","CODIGO_SITUACAO_FISCAL","DATA_SITUACAO_FISCAL" FROM CAD_SITUACAO_FISCAL_MAT
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_NATUREZA_LEGAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_NATUREZA_LEGAL" ("ID", "NATUREZA_LEGAL") AS 
  (
    SELECT DISTINCT TNC_COD_NATURALEZA AS ID,
    TNC_NOM_NATURALEZA AS natureza_legal
    FROM APL_PAR.TAB_NAT_CONTRIBUYENTE@dl_cent 
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_NAO_CONTRIBUINTE_ICMS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_NAO_CONTRIBUINTE_ICMS" ("CNPJ", "NOME", "INSCRICAO_ESTADUAL", "FONTE") AS 
  (
    SELECT "CNPJ","NOME","INSCRICAO_ESTADUAL","FONTE" FROM CAD_NAO_CONTRIBUINTE_MAT
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_NAO_CONTRIBUINTE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_NAO_CONTRIBUINTE" ("ID", "ID_TIPO_REGIME_TRIBUTARIO", "CODIGO_REGIME") AS 
  (
    SELECT DISTINCT ID_contribuinte_geral AS ID, ID_tipo_regime_tributario, CODIGO_REGIME
    FROM CAD_CONTRIBUINTE_GERAL_MAT
    WHERE ID_tipo_regime_tributario = 'NAO_CONTRIBUINTE'
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_ISENTO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_ISENTO" ("ID", "ID_TIPO_REGIME_TRIBUTARIO", "CODIGO_REGIME") AS 
  (
    SELECT DISTINCT ID_contribuinte_geral AS ID, ID_tipo_regime_tributario, CODIGO_REGIME
    FROM CAD_CONTRIBUINTE_GERAL_MAT
    WHERE ID_tipo_regime_tributario = 'ISENTO'
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_INSCRICAO_ESTADUAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_INSCRICAO_ESTADUAL" ("ID", "CNPJ", "RAZAO_SOCIAL", "NOME_FANTASIA", "EMAIL", "FAX", "TELEFONE", "CODIGO_REGIME_MERCANTIL", "NUMERO_LICENCA", "AREA", "ID_USUARIO", "ID_TIPO_ESTABELECIMENTO", "NIVEL_CUMPRIMENTO", "ID_UNIDADE", "ID_TIPO_CONTRIBUICAO", "ID_TIPO_REGIME_TRIBUTARIO", "ID_CONTRIBUINTE_GERAL", "CNAE") AS 
  (
    SELECT 
        RGE_RUC AS ID,
        geral.RGE_CGC_CPF AS cnpj,
        jur.RJU_NOMBRE_COMERCIAL AS razao_social,
        est.RES_NOM_ESTABLECIMIENTO AS nome_fantasia,
        est.RES_COR_ELECTRONICO AS email, 
        CONCAT(CONCAT(est.RES_DDD_FAX,'-'),est.RES_FAX) as fax, 
        CONCAT(CONCAT(est.RES_DDD_TELEFONO,'-'),est.RES_TELEFONO) as telefone,
        jur.RJU_NUM_REG_MERCANTIL AS codigo_regime_mercantil, 
        jur.RJU_LICENCIA AS numero_licenca,
        CASE WHEN jur.RJU_ARE_UTI_ESTABLECIMIENTOS IS NULL THEN 0
                    ELSE jur.RJU_ARE_UTI_ESTABLECIMIENTOS
        END as area,
        RES_TUS_COD_USUARIO AS ID_usuario,
        CASE RES_TIP_ESTABLECIMIENTO WHEN 1 THEN 'MATRIZ'
                    WHEN 2 THEN 'FILIAL'
                    WHEN 3 THEN 'DEPOSITO'
                    WHEN 4 THEN 'OUTROS'
                    WHEN 5 THEN 'PRINCIPAL'
                    END as ID_tipo_estabelecimento, 
    CASE RGE_NIVELCUMPRIMENTO WHEN 1 THEN 'BOM'
                    WHEN 2 THEN 'REGULAR'
                    WHEN 3 THEN 'MAU'
                    ELSE 'OUTRO'
                END as nivel_cumprimento,
    RES_TAB_COD_UNIDAD AS ID_unidade,
    CASE RGE_TIPO_CADASTRO WHEN 1 THEN 'CONTRIBUINTE_ICMS'
                    WHEN 2 THEN 'CONTRIBUINTE_IPVA'
                    WHEN 3 THEN 'NAO_CONTRIBUINTE'
                END as ID_tipo_contribuicao, 
    CASE RGE_RUC_CONDICION
                    WHEN 0 THEN 'EXTRA_CADASTRO' 
                    WHEN 1 THEN 'CONTRIBUINTE_NORMAL'
                    WHEN 3 THEN 'PEM'
                    WHEN 4 THEN 'SUBSTITUTO_TRIBUTARIO'
                    WHEN 5 THEN 'ISENTO'
                    WHEN 7 THEN 'SIMPLES_NACIONAL'
                    WHEN 8 THEN 'SIMEI'
                    WHEN 9 THEN 'NAO_CONTRIBUINTE'
    END as ID_tipo_regime_tributario,
    CONCAT(CONCAT(CONCAT(CONCAT(RGE_CGC_CPF,'-'),RGE_NOMBRE),'-'),RGE_RUC_CONDICION) ID_contribuinte_geral,
    RCF_TCF_CODIGO_CNAE AS CNAE
    FROM TAXMAOC.RUC_ESTABLECIMIENTOS@dl_cent  est
    INNER JOIN
         TAXMAOC.RUC_JURIDICOS@dl_cent  jur
    ON
        RES_RUC_ESTABLECIMIENTO = RJU_RUC_JURIDICO
    INNER JOIN     
         TAXMAOC.RUC_GENERAL@dl_cent geral
    ON
        RES_RUC_ESTABLECIMIENTO = RGE_RUC
    INNER JOIN
         TAXMAOC.RUC_CNAE_FISCAL@dl_cent  cnae
    ON  
        RES_RUC_ESTABLECIMIENTO = RCF_RGE_RUC
        AND RCF_TIPO_CNAE = '1'
    WHERE  
    RGE_TIPO_CADASTRO = 1 
    AND RGE_TIP_PERSONA = 2
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_IMPOSTO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_IMPOSTO" ("ID", "ID_PERIODICIDADE") AS 
  (
    SELECT DISTINCT ROB_TIM_COD_IMPUESTO AS ID,
    CASE ROB_PERIODICIDAD_OBLIG 
                    WHEN 1 THEN 'ANUAL'
                    WHEN 2 THEN 'MENSAL'
                ELSE 'NAO_DEFINIDO'
                END as ID_periodicidade 
    FROM TAXMAOC.RUC_OBLIGACIONES@dl_cent 
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_FOI_DESABILITADO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_FOI_DESABILITADO" ("ID_EVENTO_DESABILITADO", "ID_ESTABELECIMENTO") AS 
  (
    SELECT DISTINCT TRD_RUC AS ID_evento_desabilitado, 
    RGE_RUC AS ID_estabelecimento 
    FROM TAXMAOC.RUC_DESABILITADOS@dl_cent , TAXMAOC.RUC_GENERAL@dl_cent geral
    WHERE TRD_RUC = geral.RGE_RUC
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_EXTRA_CADASTRO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_EXTRA_CADASTRO" ("ID", "ID_TIPO_REGIME_TRIBUTARIO", "CODIGO_REGIME") AS 
  (
    SELECT DISTINCT ID_contribuinte_geral AS ID, ID_tipo_regime_tributario, CODIGO_REGIME
    FROM CAD_CONTRIBUINTE_GERAL_MAT
    WHERE ID_tipo_regime_tributario = 'EXTRA_CADASTRO'
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_ESTABELECIMENTO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_ESTABELECIMENTO" ("CNPJ", "INSCRICAO_ESTADUAL", "DATA_SITUACAO_CADASTRAL_ATUAL", "RAZAO_SOCIAL", "NOME_FANTASIA", "EMAIL", "FAX", "TELEFONE", "CODIGO_REGIME_MERCANTIL", "NUMERO_LICENCA", "AREA", "SITUACAO_FISCAL", "ID_USUARIO", "ID_TIPO_ESTABELECIMENTO", "NIVEL_CUMPRIMENTO", "ID_UNIDADE", "ID_TIPO_CONTRIBUICAO", "ID_TIPO_REGIME_TRIBUTARIO", "ID_CONTRIBUINTE_GERAL", "CNAE", "ROTULO") AS 
  (
    SELECT "CNPJ","INSCRICAO_ESTADUAL","DATA_SITUACAO_CADASTRAL_ATUAL","RAZAO_SOCIAL","NOME_FANTASIA","EMAIL","FAX","TELEFONE","CODIGO_REGIME_MERCANTIL","NUMERO_LICENCA","AREA","SITUACAO_FISCAL","ID_USUARIO","ID_TIPO_ESTABELECIMENTO","NIVEL_CUMPRIMENTO","ID_UNIDADE","ID_TIPO_CONTRIBUICAO","ID_TIPO_REGIME_TRIBUTARIO","ID_CONTRIBUINTE_GERAL","CNAE","ROTULO" FROM CAD_ESTABELECIMENTO_MAT
) WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_ENDERECO_REPRESENTANTES
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_ENDERECO_REPRESENTANTES" ("ID", "ESTADO", "LOGRADOURO", "NUMERO", "COMPLEMENTO", "REFERENCIA", "CAIXA_POSTAL", "CEP", "LATITUDE", "LONGITUDE", "ID_ESTADO", "ID_CIDADE", "ID_BAIRRO", "ID_LOGRADOURO", "ID_CEP", "CNPJ", "INSCRICAO_ESTADUAL", "ROTULO") AS 
  (
   SELECT RRL_RUC_REPRESENTANTE AS ID, 
        CASE RRL_TES_COD_ESTADO 
                            WHEN 'AC' THEN 'ACRE'
                            WHEN 'AL' THEN 'ALAGOAS'
                            WHEN 'AP' THEN 'AMAPA'
                            WHEN 'AM' THEN 'AMAZONAS'
                            WHEN 'BA' THEN 'BAHIA'
                            WHEN 'CE' THEN 'CEARA'
                            WHEN 'ES' THEN 'ESPIRITO_SANTO'
                            WHEN 'GO' THEN 'GOIAS'
                            WHEN 'MA' THEN 'MARANHAO'
                            WHEN 'MT' THEN 'MATO_GROSSO'
                            WHEN 'MS' THEN 'MATO_GROSSO DO SUL'
                            WHEN 'MG' THEN 'MINAS_GERAIS'
                            WHEN 'PA' THEN 'PARA'
                            WHEN 'PB' THEN 'PARAIBA'
                            WHEN 'PR' THEN 'PARANA'
                            WHEN 'PE' THEN 'PERNAMBUCO'
                            WHEN 'PI' THEN 'PIAUI'
                            WHEN 'RJ' THEN 'RIO_DE_JANEIRO'
                            WHEN 'RN' THEN 'RIO_GRANDE_DO_NORTE'
                            WHEN 'RS' THEN 'RIO_GRANDE_DO_SUL'
                            WHEN 'RO' THEN 'RONDONIA'
                            WHEN 'RR' THEN 'RORAIMA'
                            WHEN 'SC' THEN 'SANTA_CATARINA'
                            WHEN 'SP' THEN 'SAO_PAULO'
                            WHEN 'SE' THEN 'SERGIPE'
                            WHEN 'TO' THEN 'TOCANTINS'
                            WHEN 'DF' THEN 'DISTRITO_FEDERAL'
                            ELSE NULL
                    END as ESTADO,
        CONCAT(CONCAT(RRL_TTL_TIP_LOGRADOURO,' '),RRL_DIRECCION) AS logradouro, 
        CASE WHEN RRL_NUMERO IS NULL THEN '' ELSE RRL_NUMERO END AS numero,
        CASE WHEN RRL_NUM_APTO_OFIC IS NULL THEN '' ELSE RRL_NUM_APTO_OFIC END AS complemento,
        CASE WHEN RRL_REFERENCIA IS NULL THEN '' ELSE RRL_REFERENCIA END AS referencia,
        RRL_ZONA_CAJ_POSTAL AS caixa_postal, 
        RRL_ZONA_POSTAL AS cep, 
        '' AS latitude, 
        '' AS longitude,
        RRL_TES_COD_ESTADO AS ID_ESTADO,
        RRL_CIUDAD AS ID_CIDADE,
        RRL_URBANIZACION AS ID_BAIRRO,
        RRL_DIRECCION AS ID_LOGRADOURO,
        RRL_ZONA_POSTAL AS ID_CEP,
        RGE_CGC_CPF AS CNPJ,
        RGE_RUC AS INSCRICAO_ESTADUAL,
        CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(RRL_TTL_TIP_LOGRADOURO,' '),RRL_DIRECCION),'-'),
        RRL_NUMERO),'-'),RRL_NUM_APTO_OFIC),'-'),RRL_URBANIZACION),'-'),RRL_ZONA_POSTAL),'-'),RRL_TES_COD_ESTADO),'-'),RRL_CIUDAD) AS ROTULO
        FROM TAXMAOC.RUC_REPRESENTANTES_LEGALES@dl_cent
        INNER JOIN
        TAXMAOC.RUC_GENERAL@dl_cent
        ON
        RRL_RUC_REPRESENTANTE = RGE_RUC
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_EMPRESA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_EMPRESA" ("ID", "ROTULO", "CNPJ_RAIZ", "RAZAO_SOCIAL", "SIGLAS", "DATA_INCORPORACAO", "VALOR_CAPITAL_SOCIAL", "DATA_CONSTITUICAO", "DATA_FECHAMENTO_LIQUIDO", "DATA_FECHAMENTO_FISCAL", "ID_PORTE", "DATA_MODIFICACAO", "ID_USUARIO", "ID_NATUREZA_LEGAL", "CNPJ") AS 
  (
    SELECT "ID","ROTULO","CNPJ_RAIZ","RAZAO_SOCIAL","SIGLAS","DATA_INCORPORACAO","VALOR_CAPITAL_SOCIAL","DATA_CONSTITUICAO","DATA_FECHAMENTO_LIQUIDO","DATA_FECHAMENTO_FISCAL","ID_PORTE","DATA_MODIFICACAO","ID_USUARIO","ID_NATUREZA_LEGAL","CNPJ" FROM CAD_EMPRESA_MAT
) WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_EMPRESA_HOLDING
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_EMPRESA_HOLDING" ("ID", "ROTULO", "CNPJ_RAIZ", "RAZAO_SOCIAL", "SIGLAS", "DATA_INCORPORACAO", "VALOR_CAPITAL_SOCIAL", "DATA_CONSTITUICAO", "DATA_FECHAMENTO_LIQUIDO", "DATA_FECHAMENTO_FISCAL", "ID_PORTE", "DATA_MODIFICACAO", "ID_USUARIO", "ID_NATUREZA_LEGAL", "INICIO_PARTICIPACAO", "FIM_PARTICIPACAO", "DATA_ATUALIZACAO", "CNPJ") AS 
  (
   SELECT "ID","ROTULO","CNPJ_RAIZ","RAZAO_SOCIAL","SIGLAS","DATA_INCORPORACAO","VALOR_CAPITAL_SOCIAL","DATA_CONSTITUICAO","DATA_FECHAMENTO_LIQUIDO","DATA_FECHAMENTO_FISCAL","ID_PORTE","DATA_MODIFICACAO","ID_USUARIO","ID_NATUREZA_LEGAL","INICIO_PARTICIPACAO","FIM_PARTICIPACAO","DATA_ATUALIZACAO","CNPJ" FROM CAD_EMPRESA_HOLDING_MAT
) WITH READ ONLY
;

SELECT DISTINCT 
    RRP_RUC_PROFESIONAL AS ID, 
    CONCAT(CONCAT(SUBSTR(RGE_CGC_CPF,0,8),'-'),RGE_NOMBRE) AS ROTULO,  
    SUBSTR(RGE_CGC_CPF,0,8) AS CNPJ_RAIZ, 
    RGE_NOMBRE AS razao_social, 
    org.RJU_SIGLAS AS siglas,
    org.RJU_FEC_INCORPORACION AS data_incorporacao,
    org.RJU_VAL_CAP_SOCIALES AS valor_capital_social,
    org.RJU_FEC_CONSTITUCION AS data_constituicao, 
    org.RJU_FEC_CIERRE_LIQUID AS data_fechamento_liquido, 
    org.RJU_FEC_CIERRE_FISCAL AS data_fechamento_fiscal, 
    CASE  
        WHEN RJU_VAL_CAP_SOCIALES <= 81000 THEN 'MEI'
                    WHEN RJU_VAL_CAP_SOCIALES > 81000 AND RJU_VAL_CAP_SOCIALES <= 3600000 THEN 'MICRO_EMPRESA'
                    WHEN RJU_VAL_CAP_SOCIALES > 360000 AND RJU_VAL_CAP_SOCIALES <= 4800000 THEN 'PEQUENO_PORTE'
                    WHEN RJU_VAL_CAP_SOCIALES > 4800000 AND RJU_VAL_CAP_SOCIALES <= 300000000 THEN 'MEDIO_PORTE'
                    WHEN RJU_VAL_CAP_SOCIALES > 300000000 THEN 'GRANDE_PORTE'
                    WHEN RJU_VAL_CAP_SOCIALES IS NULL THEN 'SEM_PORTE'
                END as ID_porte,
    RGE_DATA_ULT_ALT AS data_modificacao, 
    org.RJU_TUS_COD_USUARIO ID_usuario, 
    org.RJU_TIP_SOCIEDAD AS ID_natureza_legal, 
    RRP_FECHA_INICIO_PARTICIPACION AS inicio_participacao,
    RRP_FECHA_FIN_PARTICIPACION AS fim_participacao,
    RRP_FEC_ACTUALIZACION AS data_atualizacao,
    CASE WHEN LENGTH(RGE_CGC_CPF) < 8
            THEN CONCAT('0',SUBSTR(RGE_CGC_CPF,0,8))
    ELSE   
                 SUBSTR(RGE_CGC_CPF,0,8)
    END AS CNPJ  
    FROM 
    TAXMAOC.RUC_GENERAL@DL_CENT geral
    INNER JOIN
    TAXMAOC.RUC_RELACION_PROFESIONAL@DL_CENT rel1
    ON RRP_RUC_CONTRIBUYENTE = geral.RGE_RUC
    INNER JOIN TAXMAOC.RUC_JURIDICOS@DL_CENT org
    ON 
    org.RJU_RUC_JURIDICO = geral.RGE_RUC
    WHERE
    LENGTH(RRP_RUC_PROFESIONAL) >= 12
    AND (RGE_TIPO_CADASTRO = 1) 
    AND  RRP_FECHA_INICIO_PARTICIPACION IS NOT NULL AND RRP_FECHA_FIN_PARTICIPACION IS NULL
     AND (RRP_FEC_ACTUALIZACION, RRP_RUC_CONTRIBUYENTE) IN
    (
            SELECT MAX(RRP_FEC_ACTUALIZACION), MAX(RRP_RUC_CONTRIBUYENTE) 
            FROM TAXMAOC.RUC_RELACION_PROFESIONAL@DL_CENT  rel2
            WHERE rel1.RRP_RUC_PROFESIONAL  = rel2.RRP_RUC_PROFESIONAL

    )
--------------------------------------------------------
--  DDL for View CAD_E_REPRESENTANTE_LEGAL_JURIDICO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_E_REPRESENTANTE_LEGAL_JURIDICO" ("ID", "NOME", "EMAIL", "FAX", "TELEFONE") AS 
  ( 
    SELECT RRL_RUC_REPRESENTANTE AS ID,
    RRL_NOM_REPRESENTANTE AS NOME,
    RRL_COR_ELECTRONICO AS email, 
    CONCAT(CONCAT(RRL_DDD_FAX,'-'),RRL_FAX) AS fax, CONCAT(CONCAT(RRL_DDD_TELEFONO,'-'),RRL_TELEFONO) AS telefone
    FROM TAXMAOC.RUC_REPRESENTANTES_LEGALES@dl_cent 
    WHERE LENGTH(RRL_RUC_REPRESENTANTE) > 12
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_E_REPRESENTANTE_LEGAL_FISICO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_E_REPRESENTANTE_LEGAL_FISICO" ("ID", "NOME", "EMAIL", "FAX", "TELEFONE") AS 
  (
    SELECT RGE_CGC_CPF AS ID,
    RRL_NOM_REPRESENTANTE AS NOME,
    RRL_COR_ELECTRONICO AS email, 
    CONCAT(CONCAT(RRL_DDD_FAX,'-'),RRL_FAX) AS fax, CONCAT(CONCAT(RRL_DDD_TELEFONO,'-'),RRL_TELEFONO) AS telefone
    FROM TAXMAOC.RUC_REPRESENTANTES_LEGALES@dl_cent 
    INNER JOIN TAXMAOC.RUC_GENERAL@dl_cent
    ON RRL_RUC_REPRESENTANTE = RGE_CGC_CPF
    WHERE RGE_TIP_PERSONA = 1
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_CONTRIBUINTE_NORMAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_CONTRIBUINTE_NORMAL" ("ID", "ID_TIPO_REGIME_TRIBUTARIO", "CODIGO_REGIME") AS 
  (
    SELECT "ID","ID_TIPO_REGIME_TRIBUTARIO","CODIGO_REGIME" 
    FROM CAD_CONTRIBUINTE_NORMAL_MAT
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_CONTRIBUINTE_ICMS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_CONTRIBUINTE_ICMS" ("CNPJ_CPF", "NOME", "INSCRICAO_ESTADUAL", "FONTE") AS 
  (
    SELECT CNPJ AS CNPJ_CPF, 
    CASE WHEN NOME_FANTASIA IS NOT NULL AND NOME_FANTASIA <> '' THEN NOME_FANTASIA ELSE RAZAO_SOCIAL END AS NOME,
    INSCRICAO_ESTADUAL,
    'CADASTRO' AS FONTE
    FROM
    CAD_ESTABELECIMENTO est
    WHERE
    ID_tipo_contribuicao = 'CONTRIBUINTE_ICMS'
    UNION ALL
    SELECT ID AS CNPJ_CPF, 
    NOME,
    INSCRICAO_ESTADUAL,
    'CADASTRO' AS FONTE
    FROM
    CAD_PESSOA pessoa
    WHERE
    ID_tipo_contribuicao = 'CONTRIBUINTE_ICMS'
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_CONTRIBUINTE_GERAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_CONTRIBUINTE_GERAL" ("ID_CONTRIBUINTE_GERAL", "ID_TIPO_REGIME_TRIBUTARIO", "CNPJ_CPF", "IE", "CODIGO_REGIME", "TIPO") AS 
  (
    SELECT "ID_CONTRIBUINTE_GERAL","ID_TIPO_REGIME_TRIBUTARIO","CNPJ_CPF","IE","CODIGO_REGIME","TIPO" FROM CAD_CONTRIBUINTE_GERAL_MAT 
  --  AND RGE_DATA_ULT_ALT IS NOT NULL
  --  AND (RGE_CGC_CPF, RGE_DATA_ULT_ALT) = ANY
  --  (
  --      SELECT RGE_CGC_CPF, MAX(RGE_DATA_ULT_ALT)
  --      FROM RUC_GENERAL@dl_cent@centn.world geral
  --      WHERE 
  --      RGE_DATA_ULT_ALT IS NOT NULL
  --      AND (((RGE_TIP_PERSONA = 1 OR RGE_TIP_PERSONA = 2) AND ((RGE_TIPO_CADASTRO = 1 OR RGE_TIPO_CADASTRO = 3))))
  --      GROUP BY(RGE_CGC_CPF)
  --  )
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_CNPJ_MULTIPLAS_ATIVAS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_CNPJ_MULTIPLAS_ATIVAS" ("CNPJ", "NUMERO_ATIVAS") AS 
  (
    select rge_CGC_CPF, count(*) as total from TAXMAOC.RUC_GENERAL@dl_cent
    where rge_tipo_cadastro = 1 and rge_tsc_sit_cadastral=1 and RGE_TIP_PERSONA = 2
    group by rge_CGC_CPF, rge_tsc_sit_cadastral
    having count(*)>1
)
;
--------------------------------------------------------
--  DDL for View CAD_ATIVIDADE_ECONOMICA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_ATIVIDADE_ECONOMICA" ("ID", "TIPO") AS 
  (
    SELECT DISTINCT RCF_TCF_CODIGO_CNAE AS ID, 
    CASE RCF_TIPO_CNAE WHEN '1' THEN 'PRINCIPAL' ELSE 'SECUNDARIA' END AS TIPO
    FROM TAXMAOC.RUC_CNAE_FISCAL@dl_cent  cnae
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_UNIDADE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_UNIDADE" ("ID", "NOME_UNIDADE") AS 
  (

    SELECT "ID","NOME_UNIDADE" FROM CAD_UNIDADE_MAT
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for View CAD_USUARIO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CAD_USUARIO" ("ID", "NOME_USUARIO") AS 
  (
    SELECT DISTINCT RES_TUS_COD_USUARIO AS ID, CONCAT('USUARIO-',RES_TUS_COD_USUARIO) AS nome_usuario  
    FROM TAXMAOC.RUC_ESTABLECIMIENTOS@dl_cent 
    UNION ALL
    SELECT DISTINCT RGE_TUS_COD_USUARIO AS ID, CONCAT('USUARIO-',RGE_TUS_COD_USUARIO) AS nome_usuario  
    FROM TAXMAOC.RUC_GENERAL@dl_cent
    UNION ALL
    SELECT DISTINCT RJU_TUS_COD_USUARIO AS ID, CONCAT('USUARIO-',RJU_TUS_COD_USUARIO) AS nome_usuario  
    FROM TAXMAOC.RUC_JURIDICOS@dl_cent 
    UNION ALL
    SELECT DISTINCT ROB_TUS_COD_USUARIO AS ID, CONCAT('USUARIO-',ROB_TUS_COD_USUARIO) as nome_usuario  
    FROM TAXMAOC.RUC_OBLIGACIONES@dl_cent 
    UNION ALL
    SELECT DISTINCT RRP_TUS_COD_USUARIO AS ID, CONCAT('USUARIO-',RRP_TUS_COD_USUARIO) as nome_usuario  
    FROM TAXMAOC.RUC_RELACION_PROFESIONAL@dl_cent 
    UNION ALL
    SELECT DISTINCT RRL_TUS_COD_USUARIO AS ID, CONCAT('USUARIO-',RRL_TUS_COD_USUARIO) AS nome_usuario 
    FROM TAXMAOC.RUC_REPRESENTANTES_LEGALES@dl_cent
)
WITH READ ONLY
;
--------------------------------------------------------
--  DDL for Materialized View CAD_TEM_SITUACAO_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TEM_SITUACAO_MAT" ("ID_OBRIGACAO_LEGAL", "ID_SITUACAO_CADASTRAL")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(ROB_RUC_OBLIGACION,'-'),ROB_TIM_COD_IMPUESTO),'-'),TO_CHAR(ROB_FEC_INIC_OBLIG,'YYYY_MM_DD')),'-'),TO_CHAR(ROB_FEC_FIN_OBLIG,'YYYY_MM_DD')),'-'), ROB_TAB_COD_UNIDAD)
    AS ID_obrigacao_legal, 
    CONCAT(CONCAT(CONCAT(CONCAT(CASE RGE_TSC_SIT_CADASTRAL WHEN 1 THEN 'ATIVA'
                    WHEN 2 THEN 'BAIXADA'
                    WHEN 3 THEN 'SUSPENSO'
                    WHEN 4 THEN 'CANCELADO'
                    WHEN 5 THEN 'PROCESSO_DE_BAIXA'
                    WHEN 6 THEN 'SUSPENSO_POR_OFICIO'
                    WHEN 7 THEN 'PROCESSO_DE_SUSPENSAO'                 
                    WHEN 8 THEN 'BAIXA_DE_OFICIO'
                END,'-'),RGE_CGC_CPF),'-'), TO_CHAR(RGE_DATA_SIT_CADASTRAL,'YYYY_MM_DD')) AS ID_situacao_cadastral 
    FROM TAXMAOC.RUC_OBLIGACIONES@DL_CENT  obl, TAXMAOC.RUC_GENERAL@DL_CENT geral 
    WHERE geral.RGE_TSC_SIT_CADASTRAL = ROB_ESTADO_OBLIG AND ROB_RUC_OBLIGACION = RGE_RUC;

  CREATE INDEX "CAD_TEM_SITUACAO_MAT_INDEX1" ON "CAD_TEM_SITUACAO_MAT" ("ID_OBRIGACAO_LEGAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_SITUACAO_MAT_INDEX2" ON "CAD_TEM_SITUACAO_MAT" ("ID_SITUACAO_CADASTRAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TEM_SITUACAO_MAT"  IS 'snapshot table for snapshot UFC_SEM.CAD_TEM_SITUACAO_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_TIPO_CONTRIBUICAO
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TIPO_CONTRIBUICAO" ("ID", "CODIGO_TIPO_CONTRIBUICAO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 30
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT CASE RGE_TIPO_CADASTRO WHEN 1 THEN 'CONTRIBUINTE_ICMS'
                    WHEN 2 THEN 'CONTRIBUINTE_IPVA'
                    WHEN 3 THEN 'NAO_CONTRIBUINTE'
                END as ID, RGE_TIPO_CADASTRO AS codigo_tipo_contribuicao
    FROM TAXMAOC.RUC_GENERAL@DL_CENT;

  CREATE UNIQUE INDEX "CAD_TIPO_CONTRIBUICAO_INDEX1" ON "CAD_TIPO_CONTRIBUICAO" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TIPO_CONTRIBUICAO_INDEX2" ON "CAD_TIPO_CONTRIBUICAO" ("CODIGO_TIPO_CONTRIBUICAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TIPO_CONTRIBUICAO"  IS 'snapshot table for snapshot UFC_SEM.CAD_TIPO_CONTRIBUICAO';
--------------------------------------------------------
--  DDL for Materialized View CAD_ESTABELECIMENTO_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_ESTABELECIMENTO_MAT" ("CNPJ", "INSCRICAO_ESTADUAL", "DATA_SITUACAO_CADASTRAL_ATUAL", "RAZAO_SOCIAL", "NOME_FANTASIA", "EMAIL", "FAX", "TELEFONE", "CODIGO_REGIME_MERCANTIL", "NUMERO_LICENCA", "AREA", "SITUACAO_FISCAL", "ID_USUARIO", "ID_TIPO_ESTABELECIMENTO", "NIVEL_CUMPRIMENTO", "ID_UNIDADE", "ID_TIPO_CONTRIBUICAO", "ID_TIPO_REGIME_TRIBUTARIO", "ID_CONTRIBUINTE_GERAL", "CNAE", "ROTULO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS (
        SELECT DISTINCT
        RGE_CGC_CPF AS CNPJ,
        RGE_RUC AS INSCRICAO_ESTADUAL,  
        TO_CHAR(RGE_DATA_SIT_CADASTRAL, 'DD/MM/YY HH24:MI:SS') AS DATA_SITUACAO_CADASTRAL_ATUAL,
        est.RES_NOM_ESTABLECIMIENTO AS razao_social,
        jur.RJU_NOMBRE_COMERCIAL AS nome_fantasia,
        est.RES_COR_ELECTRONICO AS email, 
        CONCAT(CONCAT(est.RES_DDD_FAX,'-'),est.RES_FAX) as fax, 
        CONCAT(CONCAT(est.RES_DDD_TELEFONO,'-'),est.RES_TELEFONO) as telefone,
        jur.RJU_NUM_REG_MERCANTIL AS codigo_regime_mercantil, 
        jur.RJU_LICENCIA AS numero_licenca,
        CASE WHEN jur.RJU_ARE_UTI_ESTABLECIMIENTOS IS NULL THEN 0
                    ELSE jur.RJU_ARE_UTI_ESTABLECIMIENTOS
        END as area,
        CASE RGE_TCO_CONDICION_PAGO WHEN 1 THEN 'HABILITADO'
                    WHEN 2 THEN 'DESABILITADO'
                END as situacao_fiscal,
        RES_TUS_COD_USUARIO AS ID_usuario,
        CASE RES_TIP_ESTABLECIMIENTO WHEN 1 THEN 'MATRIZ'
                    WHEN 2 THEN 'FILIAL'
                    WHEN 3 THEN 'DEPOSITO'
                    WHEN 4 THEN 'OUTROS'
                    WHEN 5 THEN 'PRINCIPAL'
                    END as ID_tipo_estabelecimento, 
    CASE RGE_NIVELCUMPRIMENTO WHEN 1 THEN 'BOM'
                    WHEN 2 THEN 'REGULAR'
                    WHEN 3 THEN 'MAU'
                END as nivel_cumprimento,
    RES_TAB_COD_UNIDAD AS ID_unidade,
    CASE RGE_TIPO_CADASTRO WHEN 1 THEN 'CONTRIBUINTE_ICMS'
                    WHEN 2 THEN 'CONTRIBUINTE_IPVA'
                    WHEN 3 THEN 'NAO_CONTRIBUINTE'
                END as ID_tipo_contribuicao, 
    CASE RGE_RUC_CONDICION
                    WHEN 0 THEN 'EXTRA_CADASTRO' 
                    WHEN 1 THEN 'CONTRIBUINTE_NORMAL'
                    WHEN 3 THEN 'PEM'
                    WHEN 4 THEN 'SUBSTITUTO_TRIBUTARIO'
                    WHEN 5 THEN 'ISENTO'
                    WHEN 7 THEN 'SIMPLES_NACIONAL'
                    WHEN 8 THEN 'SIMEI'
                    WHEN 9 THEN 'NAO_CONTRIBUINTE'
    END as ID_tipo_regime_tributario,
    CONCAT(CONCAT(CONCAT(CONCAT(RGE_CGC_CPF,'-'),RGE_NOMBRE),'-'),RGE_RUC_CONDICION) ID_contribuinte_geral,
    RCF_TCF_CODIGO_CNAE AS CNAE,
    CONCAT(CONCAT(RGE_CGC_CPF,'-'),jur.RJU_NOMBRE_COMERCIAL) AS ROTULO
    FROM TAXMAOC.RUC_ESTABLECIMIENTOS@DL_CENT  est
    INNER JOIN
         TAXMAOC.RUC_JURIDICOS@DL_CENT  jur
    ON
        RES_RUC_ESTABLECIMIENTO = RJU_RUC_JURIDICO
    INNER JOIN     
         TAXMAOC.RUC_GENERAL@DL_CENT geral
    ON
        RES_RUC_ESTABLECIMIENTO = RGE_RUC
    INNER JOIN
         TAXMAOC.RUC_CNAE_FISCAL@DL_CENT  cnae
    ON  
        RES_RUC_ESTABLECIMIENTO = RCF_RGE_RUC
        AND RCF_TIPO_CNAE = 1
    WHERE  
    RGE_TIPO_CADASTRO = 1 
    AND RGE_TIP_PERSONA = 2
    AND (TO_CHAR(RGE_DATA_SIT_CADASTRAL, 'DD/MM/YY HH24:MI:SS'), TO_CHAR(RGE_DATA_ULT_ALT, 'DD/MM/YY HH24:MI:SS'), RGE_RUC) = (
        SELECT MAX(TO_CHAR(RGE_DATA_SIT_CADASTRAL, 'DD/MM/YY HH24:MI:SS')) AS DATA_SITUACAO_CADASTRAL_MAX, 
        MAX(TO_CHAR(RGE_DATA_SIT_CADASTRAL, 'DD/MM/YY HH24:MI:SS')) AS DATA_ULTIMA_ALTERACAO_MAX,
        MAX(RGE_RUC)
        FROM TAXMAOC.RUC_GENERAL@DL_CENT T2
        WHERE RGE_TIPO_CADASTRO = 1 
            AND RGE_TIP_PERSONA = 2 
            AND geral.RGE_CGC_CPF = T2.RGE_CGC_CPF
    )
);

  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX9" ON "CAD_ESTABELECIMENTO_MAT" ("CODIGO_REGIME_MERCANTIL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX1" ON "CAD_ESTABELECIMENTO_MAT" ("CNPJ") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX10" ON "CAD_ESTABELECIMENTO_MAT" ("NUMERO_LICENCA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX11" ON "CAD_ESTABELECIMENTO_MAT" ("AREA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX12" ON "CAD_ESTABELECIMENTO_MAT" ("SITUACAO_FISCAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX13" ON "CAD_ESTABELECIMENTO_MAT" ("ID_USUARIO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX14" ON "CAD_ESTABELECIMENTO_MAT" ("ID_TIPO_ESTABELECIMENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX15" ON "CAD_ESTABELECIMENTO_MAT" ("NIVEL_CUMPRIMENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX16" ON "CAD_ESTABELECIMENTO_MAT" ("ID_UNIDADE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX17" ON "CAD_ESTABELECIMENTO_MAT" ("ID_TIPO_CONTRIBUICAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX18" ON "CAD_ESTABELECIMENTO_MAT" ("ID_TIPO_REGIME_TRIBUTARIO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX19" ON "CAD_ESTABELECIMENTO_MAT" ("ID_CONTRIBUINTE_GERAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX20" ON "CAD_ESTABELECIMENTO_MAT" ("CNAE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX21" ON "CAD_ESTABELECIMENTO_MAT" ("ROTULO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX3" ON "CAD_ESTABELECIMENTO_MAT" ("DATA_SITUACAO_CADASTRAL_ATUAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX4" ON "CAD_ESTABELECIMENTO_MAT" ("RAZAO_SOCIAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX5" ON "CAD_ESTABELECIMENTO_MAT" ("NOME_FANTASIA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX6" ON "CAD_ESTABELECIMENTO_MAT" ("EMAIL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX7" ON "CAD_ESTABELECIMENTO_MAT" ("FAX") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ESTABELECIMENTO_MAT_INDEX8" ON "CAD_ESTABELECIMENTO_MAT" ("TELEFONE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_ESTABELECIMENTO_MAT"  IS 'snapshot table for snapshot CAD_ESTABELECIMENTO_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_EVENTO_DESABILITADO
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_EVENTO_DESABILITADO" ("ID", "ROTULO", "ID_REGISTRO_DESABILITADO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT CONCAT(CONCAT(CONCAT(CONCAT(TRD_RUC,'-'),TO_CHAR(TRD_DT_INICIO,'YYYY_MM_DD')),'-'),TO_CHAR(TRD_DT_FIM,'YYYY_MM_DD'))  AS ID, 
    CONCAT(CONCAT(RES_NOM_ESTABLECIMIENTO,'-'),TRD_RUC) AS rotulo, 
    CONCAT(CONCAT(CONCAT(CONCAT(TRD_RUC,'-'),TO_CHAR(TRD_DT_INICIO,'YYYY_MM_DD')),'-'),TO_CHAR(TRD_DT_FIM,'YYYY_MM_DD')) 
    AS ID_registro_desabilitado 
    FROM TAXMAOC.RUC_DESABILITADOS@DL_CENT , TAXMAOC.RUC_ESTABLECIMIENTOS@DL_CENT  
    WHERE TRD_RUC = RES_RUC_ESTABLECIMIENTO;

  CREATE UNIQUE INDEX "CAD_EVENTO_DESABILITADO_INDEX1" ON "CAD_EVENTO_DESABILITADO" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_EVENTO_DESABILITADO_INDEX2" ON "CAD_EVENTO_DESABILITADO" ("ROTULO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE UNIQUE INDEX "CAD_EVENTO_DESABILITADO_INDEX3" ON "CAD_EVENTO_DESABILITADO" ("ID_REGISTRO_DESABILITADO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_EVENTO_DESABILITADO"  IS 'snapshot table for snapshot UFC_SEM.CAD_EVENTO_DESABILITADO';
--------------------------------------------------------
--  DDL for Materialized View CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT" ("ID", "ID_QUALIFICACAO", "PERCENTUAL_PARTICIPACAO", "ID_USUARIO", "ID_UNIDADE", "ID_EMPRESA", "ID_SOCIO", "INICIO_PARTICIPACAO", "FIM_PARTICIPACAO", "DATA_ATUALIZACAO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT  
    CASE WHEN RRP_TIPO_RELACION = 101 THEN CONCAT(CONCAT(CONCAT(CONCAT('SOCIO' ,'-'),SUBSTR(RGE_CGC_CPF,0,8)),'-'),RRP_RUC_PROFESIONAL) 
    ELSE CONCAT(CONCAT(CONCAT(CONCAT(
    TRANSLATE( TGE_NOMBRE_DESCRIPCION , 'Â¿Â¿Â¿Â¿YÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃ¥Ã¡Ã§Ã©Ã­Ã³ÃºÃ Ã¨Ã¬Ã²Ã¹Ã¢ÃªÃ®Ã´Ã»Ã£ÃµÃ«Ã¼Ã¯Ã¶Ã±Ã½Ã¿',
    'SZszYACEIOUAEIOUAEIOUAOEUIONYaaceiouaeiouaeiouaoeuionyy'),'-'),SUBSTR(RGE_CGC_CPF,0,8)),'-'),RRP_RUC_PROFESIONAL) END AS ID,
    CASE WHEN RRP_TIPO_RELACION = 101 THEN 'SOCIO' ELSE 
    TRANSLATE( TGE_NOMBRE_DESCRIPCION , 'Â¿Â¿Â¿Â¿YÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃ¥Ã¡Ã§Ã©Ã­Ã³ÃºÃ Ã¨Ã¬Ã²Ã¹Ã¢ÃªÃ®Ã´Ã»Ã£ÃµÃ«Ã¼Ã¯Ã¶Ã±Ã½Ã¿',
    'SZszYACEIOUAEIOUAEIOUAOEUIONYaaceiouaeiouaeiouaoeuionyy') END AS ID_qualificacao, 
    RRP_PERCENTUAL_PARTICIPACION AS percentual_participacao, 
    RRP_TUS_COD_USUARIO AS ID_usuario,
    RRP_TAB_COD_UNIDAD AS ID_unidade, 
    RGE_RUC AS ID_empresa,
    CASE WHEN LENGTH(RRP_RUC_PROFESIONAL) = 10 THEN CONCAT('0',RRP_RUC_PROFESIONAL)
    WHEN LENGTH(RRP_RUC_PROFESIONAL) = 9 THEN CONCAT('00',RRP_RUC_PROFESIONAL) 
    ELSE CONCAT('',RRP_RUC_PROFESIONAL) END AS ID_socio, 
    RRP_FECHA_INICIO_PARTICIPACION AS inicio_participacao,
    RRP_FECHA_FIN_PARTICIPACION AS fim_participacao,
    RRP_FEC_ACTUALIZACION AS data_atualizacao
    FROM 
    TAXMAOC.RUC_GENERAL@DL_CENT geral
    INNER JOIN
    TAXMAOC.RUC_RELACION_PROFESIONAL@DL_CENT  rel1
    ON RRP_RUC_CONTRIBUYENTE = geral.RGE_RUC
    inner join
            APL_PAR.TAB_GENERICA@DL_CENT
            on
            rrp_tipo_relacion  = TGE_COD_TIP_TABLA
            and 
            TGE_TIP_TABLA = 34
    WHERE
    LENGTH(RRP_RUC_PROFESIONAL) < 12
    AND (RGE_TIPO_CADASTRO = 1) 
    AND  RRP_FECHA_INICIO_PARTICIPACION IS NOT NULL AND RRP_FECHA_FIN_PARTICIPACION IS NULL
    AND (RRP_FEC_ACTUALIZACION, RRP_RUC_CONTRIBUYENTE) IN
    (
            SELECT MAX(RRP_FEC_ACTUALIZACION), MAX(RRP_RUC_CONTRIBUYENTE) 
            FROM TAXMAOC.RUC_RELACION_PROFESIONAL@DL_CENT  rel2
            WHERE rel1.RRP_RUC_PROFESIONAL  = rel2.RRP_RUC_PROFESIONAL

    );

  CREATE UNIQUE INDEX "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT_INDEX1" ON "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT_INDEX10" ON "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT" ("DATA_ATUALIZACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT_INDEX2" ON "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT" ("ID_EMPRESA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT_INDEX3" ON "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT" ("ID_SOCIO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT_INDEX4" ON "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT" ("ID_QUALIFICACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT_INDEX5" ON "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT" ("INICIO_PARTICIPACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT_INDEX6" ON "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT" ("PERCENTUAL_PARTICIPACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT_INDEX7" ON "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT" ("ID_USUARIO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT_INDEX8" ON "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT" ("ID_UNIDADE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT_INDEX9" ON "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT" ("FIM_PARTICIPACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT"  IS 'snapshot table for snapshot UFC_SEM.CAD_SOCIEDADE_COM_PESSOA_FISICA_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_TEM_REPRESENTANTE_JURIDICO_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TEM_REPRESENTANTE_JURIDICO_MAT" ("ID_REPRESENTANTE", "ID_SOCIEDADE", "ID_QUALIFICACAO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT
    RRL_RUC_REPRESENTANTE AS ID_representante, 
    CASE WHEN RRP_CARGO_SOCIO IS NULL OR RRP_TIPO_RELACION = 101 THEN CONCAT(CONCAT(CONCAT(CONCAT('SOCIO' ,'-'),SUBSTR(LPAD(TO_CHAR("RGE_CGC_CPF"),14,'0'),1,8)),'-'),RRP_RUC_PROFESIONAL) 
    ELSE CONCAT(CONCAT(CONCAT(CONCAT(
    TRANSLATE( RRP_CARGO_SOCIO , 'Â¿Â¿Â¿Â¿YÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃ¥Ã¡Ã§Ã©Ã­Ã³ÃºÃ Ã¨Ã¬Ã²Ã¹Ã¢ÃªÃ®Ã´Ã»Ã£ÃµÃ«Ã¼Ã¯Ã¶Ã±Ã½Ã¿',
    'SZszYACEIOUAEIOUAEIOUAOEUIONYaaceiouaeiouaeiouaoeuionyy'),'-'),SUBSTR(LPAD(TO_CHAR("RGE_CGC_CPF"),14,'0'),1,8)),'-'),RRP_RUC_PROFESIONAL) END AS ID_sociedade,
        REGEXP_REPLACE(TRANSLATE( RRP_CARGO_SOCIO , 'Â¿Â¿Â¿Â¿YÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃ¥Ã¡Ã§Ã©Ã­Ã³ÃºÃ Ã¨Ã¬Ã²Ã¹Ã¢ÃªÃ®Ã´Ã»Ã£ÃµÃ«Ã¼Ã¯Ã¶Ã±Ã½Ã¿',
    'SZszYACEIOUAEIOUAEIOUAOEUIONYaaceiouaeiouaeiouaoeuionyy'),'\\s','_') AS ID_qualificacao
    FROM TAXMAOC.RUC_GENERAL@DL_CENT geral, TAXMAOC.RUC_REPRESENTANTES_LEGALES@DL_CENT rep, TAXMAOC.RUC_RELACION_PROFESIONAL@DL_CENT  rel 
    WHERE rel.RRP_RUC_CONTRIBUYENTE = geral.RGE_RUC 
    AND rel.RRP_RUC_PROFESIONAL = rep.RRL_RUC_REPRESENTANTE 
    AND LENGTH(RRL_RUC_REPRESENTANTE) > 12
    AND (RRL_FEC_ACTUALIZACION) IN 
    (
        SELECT MAX(RRL_FEC_ACTUALIZACION)
        FROM TAXMAOC.RUC_REPRESENTANTES_LEGALES@DL_CENT re
        WHERE re.RRL_RUC_REPRESENTANTE = rep.RRL_RUC_REPRESENTANTE
    );

  CREATE INDEX "CAD_TEM_REPRESENTANTE_JURIDICO_MAT_INDEX1" ON "CAD_TEM_REPRESENTANTE_JURIDICO_MAT" ("ID_REPRESENTANTE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_REPRESENTANTE_JURIDICO_MAT_INDEX2" ON "CAD_TEM_REPRESENTANTE_JURIDICO_MAT" ("ID_SOCIEDADE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TEM_REPRESENTANTE_JURIDICO_MAT"  IS 'snapshot table for snapshot UFC_SEM.CAD_TEM_REPRESENTANTE_JURIDICO_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_SOCIEDADE_COM_HOLDING_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_SOCIEDADE_COM_HOLDING_MAT" ("ID", "ID_QUALIFICACAO", "PERCENTUAL_PARTICIPACAO", "ID_USUARIO", "ID_UNIDADE", "ID_EMPRESA", "ID_SOCIO", "INICIO_PARTICIPACAO", "FIM_PARTICIPACAO", "DATA_ATUALIZACAO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT
    CASE WHEN RRP_TIPO_RELACION = 101 THEN CONCAT(CONCAT(CONCAT(CONCAT('SOCIO' ,'-'),SUBSTR(RGE_CGC_CPF,0,8)),'-'),RRP_RUC_PROFESIONAL) 
    ELSE CONCAT(CONCAT(CONCAT(CONCAT(
    TRANSLATE( TGE_NOMBRE_DESCRIPCION , 'Â¿Â¿Â¿Â¿YÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃ¥Ã¡Ã§Ã©Ã­Ã³ÃºÃ Ã¨Ã¬Ã²Ã¹Ã¢ÃªÃ®Ã´Ã»Ã£ÃµÃ«Ã¼Ã¯Ã¶Ã±Ã½Ã¿',
    'SZszYACEIOUAEIOUAEIOUAOEUIONYaaceiouaeiouaeiouaoeuionyy'),'-'),SUBSTR(RGE_CGC_CPF,0,8)),'-'),RRP_RUC_PROFESIONAL) END AS ID,
    CASE WHEN RRP_TIPO_RELACION = 101 THEN 'SOCIO' ELSE 
    TRANSLATE( TGE_NOMBRE_DESCRIPCION , 'Â¿Â¿Â¿Â¿YÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃ¥Ã¡Ã§Ã©Ã­Ã³ÃºÃ Ã¨Ã¬Ã²Ã¹Ã¢ÃªÃ®Ã´Ã»Ã£ÃµÃ«Ã¼Ã¯Ã¶Ã±Ã½Ã¿',
    'SZszYACEIOUAEIOUAEIOUAOEUIONYaaceiouaeiouaeiouaoeuionyy') END AS ID_qualificacao,  
    RRP_PERCENTUAL_PARTICIPACION AS percentual_participacao, RRP_TUS_COD_USUARIO AS ID_usuario,
    RRP_TAB_COD_UNIDAD AS ID_unidade, 
    RGE_RUC AS ID_empresa,
    RRP_RUC_PROFESIONAL AS ID_socio, 
    RRP_FECHA_INICIO_PARTICIPACION AS inicio_participacao,
    RRP_FECHA_FIN_PARTICIPACION AS fim_participacao,
    RRP_FEC_ACTUALIZACION AS data_atualizacao
    FROM 
    TAXMAOC.RUC_GENERAL@DL_CENT geral
    INNER JOIN
    TAXMAOC.RUC_RELACION_PROFESIONAL@DL_CENT  rel1
    ON RRP_RUC_CONTRIBUYENTE = geral.RGE_RUC
    inner join
            APL_PAR.TAB_GENERICA@DL_CENT 
            on
            rrp_tipo_relacion  = TGE_COD_TIP_TABLA
            and 
            TGE_TIP_TABLA = 34
    WHERE
    LENGTH(RRP_RUC_PROFESIONAL) >= 12
    AND (RGE_TIPO_CADASTRO = 1) 
    AND  RRP_FECHA_INICIO_PARTICIPACION IS NOT NULL AND RRP_FECHA_FIN_PARTICIPACION IS NULL
     AND (RRP_FEC_ACTUALIZACION, RRP_RUC_CONTRIBUYENTE) IN
    (
            SELECT MAX(RRP_FEC_ACTUALIZACION), MAX(RRP_RUC_CONTRIBUYENTE) 
            FROM TAXMAOC.RUC_RELACION_PROFESIONAL@DL_CENT  rel2
            WHERE rel1.RRP_RUC_PROFESIONAL  = rel2.RRP_RUC_PROFESIONAL

    );

  CREATE UNIQUE INDEX "CAD_SOCIEDADE_COM_HOLDING_MAT_INDEX1" ON "CAD_SOCIEDADE_COM_HOLDING_MAT" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_HOLDING_MAT_INDEX10" ON "CAD_SOCIEDADE_COM_HOLDING_MAT" ("DATA_ATUALIZACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_HOLDING_MAT_INDEX2" ON "CAD_SOCIEDADE_COM_HOLDING_MAT" ("ID_EMPRESA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_HOLDING_MAT_INDEX3" ON "CAD_SOCIEDADE_COM_HOLDING_MAT" ("ID_SOCIO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_HOLDING_MAT_INDEX4" ON "CAD_SOCIEDADE_COM_HOLDING_MAT" ("ID_QUALIFICACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_HOLDING_MAT_INDEX5" ON "CAD_SOCIEDADE_COM_HOLDING_MAT" ("PERCENTUAL_PARTICIPACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_HOLDING_MAT_INDEX6" ON "CAD_SOCIEDADE_COM_HOLDING_MAT" ("ID_USUARIO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_HOLDING_MAT_INDEX7" ON "CAD_SOCIEDADE_COM_HOLDING_MAT" ("ID_UNIDADE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_HOLDING_MAT_INDEX8" ON "CAD_SOCIEDADE_COM_HOLDING_MAT" ("INICIO_PARTICIPACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SOCIEDADE_COM_HOLDING_MAT_INDEX9" ON "CAD_SOCIEDADE_COM_HOLDING_MAT" ("FIM_PARTICIPACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_SOCIEDADE_COM_HOLDING_MAT"  IS 'snapshot table for snapshot UFC_SEM.CAD_SOCIEDADE_COM_HOLDING_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_TEM_FILIAL_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TEM_FILIAL_MAT" ("ID_EMPRESA", "ID_ESTABELECIMENTO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT RGE_RUC AS ID_empresa, 
    est.RES_RUC_ESTABLECIMIENTO AS ID_estabelecimento
    FROM TAXMAOC.RUC_ESTABLECIMIENTOS@DL_CENT  est, TAXMAOC.RUC_GENERAL@DL_CENT geral 
    WHERE RGE_TIP_PERSONA = 2 AND RGE_TIPO_CADASTRO = 1
    AND geral.RGE_RUC = est.RES_RUC_ESTABLECIMIENTO AND est.RES_TIP_ESTABLECIMIENTO = 2;

  CREATE INDEX "CAD_TEM_FILIAL_MAT_INDEX1" ON "CAD_TEM_FILIAL_MAT" ("ID_EMPRESA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_FILIAL_MAT_INDEX2" ON "CAD_TEM_FILIAL_MAT" ("ID_ESTABELECIMENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TEM_FILIAL_MAT"  IS 'snapshot table for snapshot UFC_SEM.CAD_TEM_FILIAL_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_TEM_REPRESENTANTE_FISICO_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TEM_REPRESENTANTE_FISICO_MAT" ("ID_REPRESENTANTE", "ID_SOCIEDADE", "ID_QUALIFICACAO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT
    RRL_RUC_REPRESENTANTE AS ID_representante, 
    CASE WHEN RRP_CARGO_SOCIO IS NULL OR RRP_TIPO_RELACION = 101 THEN CONCAT(CONCAT(CONCAT(CONCAT('SOCIO' ,'-'),SUBSTR(LPAD(TO_CHAR("RGE_CGC_CPF"),14,'0'),1,8)),'-'),RRP_RUC_PROFESIONAL) 
    ELSE CONCAT(CONCAT(CONCAT(CONCAT(
    TRANSLATE( RRP_CARGO_SOCIO , 'Â¿Â¿Â¿Â¿YÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃ¥Ã¡Ã§Ã©Ã­Ã³ÃºÃ Ã¨Ã¬Ã²Ã¹Ã¢ÃªÃ®Ã´Ã»Ã£ÃµÃ«Ã¼Ã¯Ã¶Ã±Ã½Ã¿',
    'SZszYACEIOUAEIOUAEIOUAOEUIONYaaceiouaeiouaeiouaoeuionyy'),'-'),SUBSTR(LPAD(TO_CHAR("RGE_CGC_CPF"),14,'0'),1,8)),'-'),RRP_RUC_PROFESIONAL) END AS ID_sociedade,
    REGEXP_REPLACE(TRANSLATE( RRP_CARGO_SOCIO , 'Â¿Â¿Â¿Â¿YÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃÃ¥Ã¡Ã§Ã©Ã­Ã³ÃºÃ Ã¨Ã¬Ã²Ã¹Ã¢ÃªÃ®Ã´Ã»Ã£ÃµÃ«Ã¼Ã¯Ã¶Ã±Ã½Ã¿',
    'SZszYACEIOUAEIOUAEIOUAOEUIONYaaceiouaeiouaeiouaoeuionyy'),'\\s','_') AS ID_qualificacao
    FROM TAXMAOC.RUC_GENERAL@DL_CENT geral, TAXMAOC.RUC_REPRESENTANTES_LEGALES@DL_CENT rep, 
    TAXMAOC.RUC_RELACION_PROFESIONAL@DL_CENT  rel 
    WHERE rel.RRP_RUC_CONTRIBUYENTE = geral.RGE_RUC 
    AND rel.RRP_RUC_PROFESIONAL = rep.RRL_RUC_REPRESENTANTE 
    AND LENGTH(RRL_RUC_REPRESENTANTE) < 13 
    AND (RRL_FEC_ACTUALIZACION) IN 
    (
        SELECT MAX(RRL_FEC_ACTUALIZACION)
        FROM TAXMAOC.RUC_REPRESENTANTES_LEGALES@DL_CENT re
        WHERE re.RRL_RUC_REPRESENTANTE = rep.RRL_RUC_REPRESENTANTE
    );

  CREATE INDEX "CAD_TEM_REPRESENTANTE_FISICO_MAT_INDEX1" ON "CAD_TEM_REPRESENTANTE_FISICO_MAT" ("ID_REPRESENTANTE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_REPRESENTANTE_FISICO_MAT_INDEX2" ON "CAD_TEM_REPRESENTANTE_FISICO_MAT" ("ID_SOCIEDADE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TEM_REPRESENTANTE_FISICO_MAT"  IS 'snapshot table for snapshot UFC_SEM.CAD_TEM_REPRESENTANTE_FISICO_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_REPRESENTANTE_PF
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_REPRESENTANTE_PF" ("ID", "CPF", "NOME", "EMAIL", "FAX", "TELEFONE")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  WITH PRIMARY KEY USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT RRL_RUC_REPRESENTANTE AS ID,
    RRL_RUC_REPRESENTANTE AS cpf, 
    RRL_NOM_REPRESENTANTE AS NOME,
    RRL_COR_ELECTRONICO AS email, 
    CONCAT(CONCAT(RRL_DDD_FAX,'-'),RRL_FAX) AS fax, CONCAT(CONCAT(RRL_DDD_TELEFONO,'-'),RRL_TELEFONO) AS telefone
    FROM TAXMAOC.RUC_REPRESENTANTES_LEGALES@DL_CENT rep 
    WHERE LENGTH(RRL_RUC_REPRESENTANTE) < 13;

  CREATE INDEX "CAD_REPRESENTANTE_PF_INDEX6" ON "CAD_REPRESENTANTE_PF" ("TELEFONE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE UNIQUE INDEX "SYS_C_SNAP$_2865PK_RUC_REPRESENTANTES_LEGALES" ON "CAD_REPRESENTANTE_PF" ("CPF") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE UNIQUE INDEX "CAD_REPRESENTANTE_PF_INDEX1" ON "CAD_REPRESENTANTE_PF" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REPRESENTANTE_PF_INDEX3" ON "CAD_REPRESENTANTE_PF" ("NOME") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REPRESENTANTE_PF_INDEX4" ON "CAD_REPRESENTANTE_PF" ("EMAIL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REPRESENTANTE_PF_INDEX5" ON "CAD_REPRESENTANTE_PF" ("FAX") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_REPRESENTANTE_PF"  IS 'snapshot table for snapshot UFC_SEM.CAD_REPRESENTANTE_PF';
--------------------------------------------------------
--  DDL for Materialized View CAD_TEM_OBRIGACAO_LEGAL
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TEM_OBRIGACAO_LEGAL" ("ID_OBRIGACAO_LEGAL", "ID_ESTABELECIMENTO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(ROB_RUC_OBLIGACION,'-'),ROB_TIM_COD_IMPUESTO),'-'),TO_CHAR(ROB_FEC_INIC_OBLIG,'YYYY_MM_DD')),'-'),TO_CHAR(ROB_FEC_FIN_OBLIG,'YYYY_MM_DD')),'-'), ROB_TAB_COD_UNIDAD) 
    AS ID_obrigacao_legal,
    ROB_RUC_OBLIGACION AS ID_estabelecimento  
    FROM TAXMAOC.RUC_OBLIGACIONES@DL_CENT  
    INNER JOIN
    TAXMAOC.RUC_GENERAL@DL_CENT
    ON
    ROB_RUC_OBLIGACION
    = 
    RGE_RUC
    AND 
    RGE_TIPO_CADASTRO = 1;

  CREATE INDEX "CAD_TEM_OBRIGACAO_LEGAL_INDEX1" ON "CAD_TEM_OBRIGACAO_LEGAL" ("ID_OBRIGACAO_LEGAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_OBRIGACAO_LEGAL_INDEX2" ON "CAD_TEM_OBRIGACAO_LEGAL" ("ID_ESTABELECIMENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TEM_OBRIGACAO_LEGAL"  IS 'snapshot table for snapshot UFC_SEM.CAD_TEM_OBRIGACAO_LEGAL';
--------------------------------------------------------
--  DDL for Materialized View CAD_SITUACAO_CADASTRAL_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_SITUACAO_CADASTRAL_MAT" ("ID", "CODIGO_SITUACAO_CADASTRAL", "TIPO_SITUACAO", "DATA_SITUACAO_CADASTRAL", "CNPJ_CPF", "STATUS_BAIXA")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT CONCAT(CONCAT(CONCAT(CONCAT(CASE RGE_TSC_SIT_CADASTRAL WHEN 1 THEN 'ATIVA'
                    WHEN 2 THEN 'BAIXADA'
                    WHEN 3 THEN 'SUSPENSA'
                    WHEN 4 THEN 'CANCELADA'
                    WHEN 5 THEN 'PROCESSO_DE_BAIXA'
                    WHEN 6 THEN 'SUSPENSA_DE_OFICIO'
                    WHEN 7 THEN 'PROCESSO_DE_SUSPENSAO'                 
                    WHEN 8 THEN 'BAIXA_DE_OFICIO'
                END,'-'),RGE_CGC_CPF),'-'), TO_CHAR(RGE_DATA_SIT_CADASTRAL,'YYYY_MM_DD')) AS ID,
    RGE_TSC_SIT_CADASTRAL AS codigo_situacao_cadastral, 
    CASE RGE_TSC_SIT_CADASTRAL WHEN 1 THEN 'ATIVA'
                    WHEN 2 THEN 'BAIXADA'
                    WHEN 3 THEN 'SUSPENSA'
                    WHEN 4 THEN 'CANCELADA'
                    WHEN 5 THEN 'PROCESSO_DE_BAIXA'
                    WHEN 6 THEN 'SUSPENSA_DE_OFICIO'
                    WHEN 7 THEN 'PROCESSO_DE_SUSPENSAO'                 
                    WHEN 8 THEN 'BAIXA_DE_OFICIO'
                END AS tipo_situacao,
    RGE_DATA_SIT_CADASTRAL AS data_situacao_cadastral, 
    RGE_CGC_CPF AS cnpj_cpf, 
    CASE RGE_TSC_SIT_CADASTRAL WHEN 2 THEN 'BAIXA'
                    WHEN 8 THEN 'BAIXA'
                    ELSE 'NÃO BAIXADO'
                END as status_baixa 
    FROM TAXMAOC.RUC_GENERAL@DL_CENT geral
    INNER JOIN
    CAD_ESTABELECIMENTO
    ON
    RGE_CGC_CPF = CNPJ
    WHERE 
    RGE_TIPO_CADASTRO = 1
    AND  
    (TO_CHAR(RGE_DATA_SIT_CADASTRAL, 'DD/MM/YY HH24:MI:SS'),  RGE_CGC_CPF) = ANY
(
SELECT DISTINCT MAX(TO_CHAR(RGE_DATA_SIT_CADASTRAL, 'DD/MM/YY HH24:MI:SS')),
RGE_CGC_CPF
FROM TAXMAOC.RUC_GENERAL@DL_CENT geral
WHERE RGE_TIPO_CADASTRO = 1
GROUP BY RGE_CGC_CPF
);

  CREATE INDEX "CAD_ST_CADASTRAL_MAT_INDEX1" ON "CAD_SITUACAO_CADASTRAL_MAT" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ST_CADASTRAL_MAT_INDEX2" ON "CAD_SITUACAO_CADASTRAL_MAT" ("CNPJ_CPF") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ST_CADASTRAL_MAT_INDEX3" ON "CAD_SITUACAO_CADASTRAL_MAT" ("TIPO_SITUACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ST_CADASTRAL_MAT_INDEX4" ON "CAD_SITUACAO_CADASTRAL_MAT" ("DATA_SITUACAO_CADASTRAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_ST_CADASTRAL_MAT_INDEX5" ON "CAD_SITUACAO_CADASTRAL_MAT" ("STATUS_BAIXA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_SITUACAO_CADASTRAL_MAT"  IS 'snapshot table for snapshot UFC_SEM.CAD_SITUACAO_CADASTRAL_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_UNIDADE_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_UNIDADE_MAT" ("ID", "NOME_UNIDADE")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT RES_TAB_COD_UNIDAD AS ID, CONCAT('UNIDADE-',RES_TAB_COD_UNIDAD) as nome_unidade  
    FROM TAXMAOC.RUC_ESTABLECIMIENTOS@DL_CENT 
    WHERE RES_TAB_COD_UNIDAD IS NOT NULL
    UNION
    SELECT DISTINCT RGE_TAB_COD_UNIDAD AS ID, CONCAT('UNIDADE-',RGE_TAB_COD_UNIDAD) as nome_unidade  
    FROM TAXMAOC.RUC_GENERAL@DL_CENT
    WHERE RGE_TAB_COD_UNIDAD IS NOT NULL
    UNION
    SELECT DISTINCT RJU_TAB_COD_UNIDAD AS ID, CONCAT('UNIDADE-',RJU_TAB_COD_UNIDAD) as nome_unidade   
    FROM TAXMAOC.RUC_JURIDICOS@DL_CENT  
    WHERE RJU_TAB_COD_UNIDAD IS NOT NULL
    UNION
    SELECT DISTINCT ROB_TAB_COD_UNIDAD AS ID, CONCAT('UNIDADE-',ROB_TAB_COD_UNIDAD) as nome_unidade  
    FROM TAXMAOC.RUC_OBLIGACIONES@DL_CENT  
    WHERE ROB_TAB_COD_UNIDAD IS NOT NULL
    UNION 
    SELECT DISTINCT RRP_TAB_COD_UNIDAD AS ID, CONCAT('UNIDADE-',RRP_TAB_COD_UNIDAD) as nome_unidade 
    FROM TAXMAOC.RUC_RELACION_PROFESIONAL@DL_CENT  
    WHERE RRP_TAB_COD_UNIDAD IS NOT NULL
    UNION
    SELECT DISTINCT RRL_TAB_COD_UNIDAD AS ID, CONCAT('UNIDADE-',RRL_TAB_COD_UNIDAD) as nome_unidade  
    FROM TAXMAOC.RUC_REPRESENTANTES_LEGALES@DL_CENT 
    WHERE RRL_TAB_COD_UNIDAD IS NOT NULL;

  CREATE INDEX "CAD_UNIDADATE_MAT_INDEX1" ON "CAD_UNIDADE_MAT" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_UNIDADATE_MAT_INDEX2" ON "CAD_UNIDADE_MAT" ("NOME_UNIDADE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_UNIDADE_MAT"  IS 'snapshot table for snapshot UFC_SEM.CAD_UNIDADE_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_SITUACAO_FISCAL_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_SITUACAO_FISCAL_MAT" ("ID", "SITUACAO", "IE", "CODIGO_SITUACAO_FISCAL", "DATA_SITUACAO_FISCAL")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT  CONCAT(CONCAT(RGE_RUC,'-'),CASE RGE_TCO_CONDICION_PAGO WHEN 1 THEN 'HABILITADO'
                    WHEN 2 THEN 'DESABILITADO'
                END) AS ID,
                CASE RGE_TCO_CONDICION_PAGO WHEN 1 THEN 'HABILITADO'
                    WHEN 2 THEN 'DESABILITADO'
                END as SITUACAO, 
           RGE_RUC AS IE,
           RGE_TCO_CONDICION_PAGO AS CODIGO_SITUACAO_FISCAL,
           RJU_FEC_CIERRE_FISCAL AS DATA_SITUACAO_FISCAL
           FROM TAXMAOC.RUC_GENERAL@DL_CENT geral
           INNER JOIN
           TAXMAOC.RUC_JURIDICOS@DL_CENT 
           ON
           rge_ruc = rju_ruc_juridico 
           WHERE RGE_TCO_CONDICION_PAGO IS NOT NULL;

  CREATE INDEX "CAD_SITUACAO_FISCAL_MAT_INDEX1" ON "CAD_SITUACAO_FISCAL_MAT" ("SITUACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SITUACAO_FISCAL_MAT_INDEX2" ON "CAD_SITUACAO_FISCAL_MAT" ("IE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SITUACAO_FISCAL_MAT_INDEX3" ON "CAD_SITUACAO_FISCAL_MAT" ("CODIGO_SITUACAO_FISCAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_SITUACAO_FISCAL_MAT_INDEX4" ON "CAD_SITUACAO_FISCAL_MAT" ("DATA_SITUACAO_FISCAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_SITUACAO_FISCAL_MAT"  IS 'snapshot table for snapshot UFC_SEM.CAD_SITUACAO_FISCAL_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_REALIZACAO_ATIVIDADE_ECONOMICA_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_REALIZACAO_ATIVIDADE_ECONOMICA_MAT" ("ID", "ID_ATIVIDADE_ECONOMICA", "INICIO_ATIVIDADE_ECONOMICA", "DATA_MODIFICACAO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT CONCAT(CONCAT(RGE_CGC_CPF,'-'),RCF_RGE_RUC||'-'||RCF_TCF_CODIGO_CNAE) AS ID, RCF_TCF_CODIGO_CNAE AS ID_atividade_economica, 
    RJU_FEC_INI_ACT_ECON AS inicio_atividade_economica, RCF_DATA_ULT_ALT AS data_modificacao
    FROM TAXMAOC.RUC_CNAE_FISCAL@DL_CENT , TAXMAOC.RUC_GENERAL@DL_CENT, TAXMAOC.RUC_JURIDICOS@DL_CENT  
    WHERE RGE_RUC = RJU_RUC_JURIDICO AND RGE_RUC = RCF_RGE_RUC
    AND RGE_TIP_PERSONA = 2
    AND RGE_TIPO_CADASTRO = 1;

  CREATE UNIQUE INDEX "CAD_REALIZACAO_ATIVIDADE_ECONOMICA_MAT_INDEX1" ON "CAD_REALIZACAO_ATIVIDADE_ECONOMICA_MAT" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REALIZACAO_ATIVIDADE_ECONOMICA__INDEX2" ON "CAD_REALIZACAO_ATIVIDADE_ECONOMICA_MAT" ("ID_ATIVIDADE_ECONOMICA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REALIZACAO_ATIVIDADE_ECONOMICA__INDEX3" ON "CAD_REALIZACAO_ATIVIDADE_ECONOMICA_MAT" ("INICIO_ATIVIDADE_ECONOMICA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REALIZACAO_ATIVIDADE_ECONOMICA__INDEX4" ON "CAD_REALIZACAO_ATIVIDADE_ECONOMICA_MAT" ("DATA_MODIFICACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_REALIZACAO_ATIVIDADE_ECONOMICA_MAT"  IS 'snapshot table for snapshot CAD_REALIZACAO_ATIVIDADE_ECONOMICA_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_OBRIGACAO_LEGAL
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_OBRIGACAO_LEGAL" ("ID", "ID_IMPOSTO", "INSCRICAO_ESTADUAL", "DATA_INICIO_OBRIGACAO_LEGAL", "DATA_FIM_OBRIGACAO_LEGAL", "ID_USUARIO", "ID_UNIDADE", "ROTULO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH FORCE ON DEMAND
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(ROB_RUC_OBLIGACION,'-'),ROB_TIM_COD_IMPUESTO),'-'),TO_CHAR(ROB_FEC_INIC_OBLIG,'YYYY_MM_DD')),'-'),TO_CHAR(ROB_FEC_FIN_OBLIG,'YYYY_MM_DD')),'-'), ROB_TAB_COD_UNIDAD) 
    AS ID, ROB_TIM_COD_IMPUESTO AS ID_imposto, 
    ROB_RUC_OBLIGACION AS inscricao_estadual, 
    TO_CHAR(ROB_FEC_INIC_OBLIG,'YYYY_MM_DD') AS data_inicio_obrigacao_legal,
    ROB_FEC_FIN_OBLIG AS data_fim_obrigacao_legal, 
    ROB_TUS_COD_USUARIO AS ID_usuario, 
    ROB_TAB_COD_UNIDAD AS ID_unidade, 
    CONCAT('ObrigaÃ§Ã£o Legal-',ROB_RUC_OBLIGACION) AS rotulo 
    FROM TAXMAOC.RUC_OBLIGACIONES@DL_CENT , TAXMAOC.RUC_GENERAL@DL_CENT 
    WHERE ROB_RUC_OBLIGACION = RGE_RUC AND ROB_FEC_ACTUALIZACION IS NOT NULL
    AND RGE_TIPO_CADASTRO = 1;

  CREATE INDEX "CAD_OBRIGACAO_LEGAL_INDEX2" ON "CAD_OBRIGACAO_LEGAL" ("ID_IMPOSTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_OBRIGACAO_LEGAL_INDEX3" ON "CAD_OBRIGACAO_LEGAL" ("INSCRICAO_ESTADUAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_OBRIGACAO_LEGAL_INDEX4" ON "CAD_OBRIGACAO_LEGAL" ("DATA_INICIO_OBRIGACAO_LEGAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_OBRIGACAO_LEGAL_INDEX5" ON "CAD_OBRIGACAO_LEGAL" ("DATA_FIM_OBRIGACAO_LEGAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_OBRIGACAO_LEGAL_INDEX6" ON "CAD_OBRIGACAO_LEGAL" ("ID_USUARIO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_OBRIGACAO_LEGAL_INDEX7" ON "CAD_OBRIGACAO_LEGAL" ("ID_UNIDADE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_OBRIGACAO_LEGAL_INDEX8" ON "CAD_OBRIGACAO_LEGAL" ("ROTULO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_OBRIGACAO_LEGAL"  IS 'snapshot table for snapshot UFC_SEM.CAD_OBRIGACAO_LEGAL';
--------------------------------------------------------
--  DDL for Materialized View CAD_NAO_CONTRIBUINTE_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_NAO_CONTRIBUINTE_MAT" ("CNPJ", "NOME", "INSCRICAO_ESTADUAL", "FONTE")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT 
        RGE_CGC_CPF AS CNPJ,
        CASE WHEN RJU_NOMBRE_COMERCIAL IS NOT NULL AND RJU_NOMBRE_COMERCIAL <> '' THEN RJU_NOMBRE_COMERCIAL  ELSE RGE_NOMBRE END AS NOME,
        RGE_RUC AS INSCRICAO_ESTADUAL,
        'CADASTRO' AS FONTE
    FROM
         TAXMAOC.RUC_JURIDICOS@DL_CENT  jur
    INNER JOIN     
         TAXMAOC.RUC_GENERAL@DL_CENT geral
    ON
        RJU_RUC_JURIDICO = RGE_RUC
    WHERE  
    RGE_TIPO_CADASTRO = 3
    AND (TO_CHAR(RGE_DATA_SIT_CADASTRAL, 'DD/MM/YY HH24:MI:SS'), TO_CHAR(RGE_DATA_ULT_ALT, 'DD/MM/YY HH24:MI:SS')) = (
        SELECT MAX(TO_CHAR(RGE_DATA_SIT_CADASTRAL, 'DD/MM/YY HH24:MI:SS')) AS DATA_SITUACAO_CADASTRAL_MAX, 
        MAX(TO_CHAR(RGE_DATA_SIT_CADASTRAL, 'DD/MM/YY HH24:MI:SS')) AS DATA_ULTIMA_ALTERACAO_MAX
        FROM TAXMAOC.RUC_GENERAL@DL_CENT T2
        WHERE
            RGE_TIPO_CADASTRO = 3
            AND geral.RGE_CGC_CPF = T2.RGE_CGC_CPF
    );

  CREATE INDEX "CAD_NAO_CONTRIBUINTE_MAT_INDEX1" ON "CAD_NAO_CONTRIBUINTE_MAT" ("CNPJ") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_NAO_CONTRIBUINTE_MAT_INDEX2" ON "CAD_NAO_CONTRIBUINTE_MAT" ("NOME") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_NAO_CONTRIBUINTE_MAT_INDEX3" ON "CAD_NAO_CONTRIBUINTE_MAT" ("INSCRICAO_ESTADUAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_NAO_CONTRIBUINTE_MAT"  IS 'snapshot table for snapshot CAD_NAO_CONTRIBUINTE_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_TEM_REALIZACAO_ATIVIDADE_ECONOMICA
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TEM_REALIZACAO_ATIVIDADE_ECONOMICA" ("ID_ESTABELECIMENTO", "ID_REALIZACAO_ATIVIDADE_ECONOMICA")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH FORCE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT geral.RGE_RUC AS ID_estabelecimento,
    CONCAT(CONCAT(RGE_CGC_CPF,'-'),RCF_RGE_RUC||'-'||RCF_TCF_CODIGO_CNAE) AS ID_realizacao_atividade_economica
    FROM TAXMAOC.RUC_CNAE_FISCAL@DL_CENT , TAXMAOC.RUC_ESTABLECIMIENTOS@DL_CENT  , TAXMAOC.RUC_GENERAL@DL_CENT geral
    WHERE RES_RUC_ESTABLECIMIENTO = RCF_RGE_RUC
    AND RES_RUC_ESTABLECIMIENTO = geral.RGE_RUC
    AND RGE_TIP_PERSONA = 2
    AND RGE_TIPO_CADASTRO = 1;

  CREATE UNIQUE INDEX "CAD_TEM_REALIZACAO_ATIVIDADE_ECONOMICA_INDEX2" ON "CAD_TEM_REALIZACAO_ATIVIDADE_ECONOMICA" ("ID_REALIZACAO_ATIVIDADE_ECONOMICA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_REALIZACAO_ATIVIDADE_ECONOMICA_INDEX1" ON "CAD_TEM_REALIZACAO_ATIVIDADE_ECONOMICA" ("ID_ESTABELECIMENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TEM_REALIZACAO_ATIVIDADE_ECONOMICA"  IS 'snapshot table for snapshot UFC_SEM.CAD_TEM_REALIZACAO_ATIVIDADE_ECONOMICA';
--------------------------------------------------------
--  DDL for Materialized View CAD_TIPO_ESTABELECIMENTO
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TIPO_ESTABELECIMENTO" ("ID", "CODIGO_TIPO_ESTABELECIMENTO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 30
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT CASE RES_TIP_ESTABLECIMIENTO WHEN 1 THEN 'MATRIZ'
                    WHEN 2 THEN 'FILIAL'
                    WHEN 3 THEN 'DEPOSITO'
                    WHEN 4 THEN 'FAZENDA_RURAL'
                    WHEN 5 THEN 'PRINCIPAL'
                    WHEN 0 THEN 'OUTROS' END as ID, RES_TIP_ESTABLECIMIENTO AS codigo_tipo_estabelecimento 
    FROM TAXMAOC.RUC_ESTABLECIMIENTOS@DL_CENT  est, 
        TAXMAOC.RUC_JURIDICOS@DL_CENT  jur 
    WHERE jur.RJU_RUC_JURIDICO = est.RES_RUC_ESTABLECIMIENTO
    AND RES_TIP_ESTABLECIMIENTO IS NOT NULL;

  CREATE UNIQUE INDEX "CAD_TIPO_ESTABELECIMENTO_INDEX1" ON "CAD_TIPO_ESTABELECIMENTO" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TIPO_ESTABELECIMENTO_INDEX2" ON "CAD_TIPO_ESTABELECIMENTO" ("CODIGO_TIPO_ESTABELECIMENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TIPO_ESTABELECIMENTO"  IS 'snapshot table for snapshot UFC_SEM.CAD_TIPO_ESTABELECIMENTO';
--------------------------------------------------------
--  DDL for Materialized View CAD_TEM_SITUACAO_CADASTRAL_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TEM_SITUACAO_CADASTRAL_MAT" ("ID_ESTABELECIMENTO", "CNPJ_CPF", "DATA_SITUACAO_CADASTRAL", "TIPO_SITUACAO", "ID_SITUACAO_CADASTRAL", "INSCRICAO_ESTADUAL")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT geral.RGE_RUC AS ID_estabelecimento, 
    RGE_CGC_CPF AS cnpj_cpf, 
    RGE_DATA_SIT_CADASTRAL AS data_situacao_cadastral,
    CASE RGE_TSC_SIT_CADASTRAL WHEN 1 THEN 'ATIVA'
                    WHEN 2 THEN 'BAIXADA'
                    WHEN 3 THEN 'SUSPENSO'
                    WHEN 4 THEN 'CANCELADO'
                    WHEN 5 THEN 'PROCESSO_DE_BAIXA'
                    WHEN 6 THEN 'SUSPENSO_POR_OFICIO'
                    WHEN 7 THEN 'PROCESSO_DE_SUSPENSAO'                 
                    WHEN 8 THEN 'BAIXA_DE_OFICIO'
    END AS TIPO_SITUACAO,
    CONCAT(CONCAT(CONCAT(CONCAT(CASE RGE_TSC_SIT_CADASTRAL WHEN 1 THEN 'ATIVA'
                    WHEN 2 THEN 'BAIXADA'
                    WHEN 3 THEN 'SUSPENSO'
                    WHEN 4 THEN 'CANCELADO'
                    WHEN 5 THEN 'PROCESSO_DE_BAIXA'
                    WHEN 6 THEN 'SUSPENSO_POR_OFICIO'
                    WHEN 7 THEN 'PROCESSO_DE_SUSPENSAO'                 
                    WHEN 8 THEN 'BAIXA_DE_OFICIO'
                END,'-'),RGE_CGC_CPF),'-'), TO_CHAR(RGE_DATA_SIT_CADASTRAL,'YYYY_MM_DD')) AS ID_situacao_cadastral,
    RGE_RUC AS inscricao_estadual
    FROM TAXMAOC.RUC_GENERAL@DL_CENT geral;

  CREATE UNIQUE INDEX "CAD_TEM_SITUACAO_CADASTRAL_MAT_INDEX1" ON "CAD_TEM_SITUACAO_CADASTRAL_MAT" ("ID_ESTABELECIMENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_SITUACAO_CADASTRAL_MAT_INDEX2" ON "CAD_TEM_SITUACAO_CADASTRAL_MAT" ("CNPJ_CPF") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_SITUACAO_CADASTRAL_MAT_INDEX3" ON "CAD_TEM_SITUACAO_CADASTRAL_MAT" ("DATA_SITUACAO_CADASTRAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_SITUACAO_CADASTRAL_MAT_INDEX4" ON "CAD_TEM_SITUACAO_CADASTRAL_MAT" ("TIPO_SITUACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_SITUACAO_CADASTRAL_MAT_INDEX5" ON "CAD_TEM_SITUACAO_CADASTRAL_MAT" ("ID_SITUACAO_CADASTRAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TEM_SITUACAO_CADASTRAL_MAT"  IS 'snapshot table for snapshot UFC_SEM.CAD_TEM_SITUACAO_CADASTRAL_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_TEM_RAZAO_SITUACAO_DESABILITADO
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TEM_RAZAO_SITUACAO_DESABILITADO" ("ID_EVENTO_DESABILITADO", "ID_RAZAO_SITUACAO_DESABILITADO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT CONCAT(CONCAT(CONCAT(CONCAT(TRD_RUC,'-'),TO_CHAR(TRD_DT_INICIO,'YYYY_MM_DD')),'-'),TO_CHAR(TRD_DT_FIM,'YYYY_MM_DD')) AS ID_evento_desabilitado, 
    dis.TRD_MOTIVO AS ID_razao_situacao_desabilitado
    FROM TAXMAOC.RUC_DESABILITADOS@DL_CENT dis, TAXMAOC.RUC_ESTABLECIMIENTOS@DL_CENT
    WHERE TRD_RUC = RES_RUC_ESTABLECIMIENTO;

   COMMENT ON MATERIALIZED VIEW "CAD_TEM_RAZAO_SITUACAO_DESABILITADO"  IS 'snapshot table for snapshot UFC_SEM.CAD_TEM_RAZAO_SITUACAO_DESABILITADO';
--------------------------------------------------------
--  DDL for Materialized View CAD_TEM_MATRIZ_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TEM_MATRIZ_MAT" ("ID_EMPRESA", "ID_ESTABELECIMENTO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT RGE_RUC AS ID_empresa, 
    est.RES_RUC_ESTABLECIMIENTO AS ID_estabelecimento
    FROM TAXMAOC.RUC_ESTABLECIMIENTOS@DL_CENT  est, TAXMAOC.RUC_GENERAL@DL_CENT geral 
    WHERE RGE_TIP_PERSONA = 2 AND RGE_TIPO_CADASTRO = 1
    AND geral.RGE_RUC = est.RES_RUC_ESTABLECIMIENTO AND est.RES_TIP_ESTABLECIMIENTO = 2;

  CREATE UNIQUE INDEX "CAD_TEM_MATRIZ_MAT_INDEX2" ON "CAD_TEM_MATRIZ_MAT" ("ID_ESTABELECIMENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE UNIQUE INDEX "CAD_TEM_MATRIZ_MAT_INDEX1" ON "CAD_TEM_MATRIZ_MAT" ("ID_EMPRESA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TEM_MATRIZ_MAT"  IS 'snapshot table for snapshot UFC_SEM.CAD_TEM_MATRIZ_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_REGISTRO_DESABILITADO_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_REGISTRO_DESABILITADO_MAT" ("URI", "INSCRICAO_ESTADUAL", "OBSERVACAO_DESABILITADO", "DATA_INICIO_DESABILITADO", "DATA_FIM_DESABILITADO", "ROTULO", "URI_USUARIO_INCLUSAO", "URI_USUARIO_EXCLUSAO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "TS_D_UFC_SEM"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT CONCAT(CONCAT(CONCAT(CONCAT(TRD_RUC,'-'),TRD_DT_INICIO),'-'),TRD_DT_FIM) AS uri ,
    TRD_RUC AS inscricao_estadual,
    TRD_OBS AS observacao_desabilitado,
    TRD_DT_INICIO AS data_inicio_desabilitado,
    TRD_DT_FIM AS data_fim_desabilitado,
    CONCAT(CONCAT(RES_NOM_ESTABLECIMIENTO,'-'),TRD_RUC) AS rotulo,
    TRD_USR_INCLUSAO AS uri_usuario_inclusao,
    TRD_USR_EXCLUSAO AS uri_usuario_exclusao
    FROM TAXMAOC.RUC_DESABILITADOS@dl_cent , TAXMAOC.RUC_ESTABLECIMIENTOS@dl_cent
    WHERE TRD_RUC = RES_RUC_ESTABLECIMIENTO
;

  CREATE INDEX "CAD_REGISTRO_DESABILITADO_MAT_INDEX1" ON "CAD_REGISTRO_DESABILITADO_MAT" ("URI") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "TS_D_UFC_SEM" ;
  CREATE INDEX "CAD_REGISTRO_DESABILITADO_MAT_INDEX2" ON "CAD_REGISTRO_DESABILITADO_MAT" ("INSCRICAO_ESTADUAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "TS_D_UFC_SEM" ;
  CREATE INDEX "CAD_REGISTRO_DESABILITADO_MAT_INDEX3" ON "CAD_REGISTRO_DESABILITADO_MAT" ("OBSERVACAO_DESABILITADO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "TS_D_UFC_SEM" ;
  CREATE INDEX "CAD_REGISTRO_DESABILITADO_MAT_INDEX4" ON "CAD_REGISTRO_DESABILITADO_MAT" ("DATA_INICIO_DESABILITADO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "TS_D_UFC_SEM" ;

   COMMENT ON MATERIALIZED VIEW "CAD_REGISTRO_DESABILITADO_MAT"  IS 'snapshot table for snapshot CAD_REGISTRO_DESABILITADO_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_PESSOA_MAT
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_PESSOA_MAT" ("ID", "CPF", "INSCRICAO_ESTADUAL", "NOME", "ID_CONTRIBUINTE_GERAL", "ID_TIPO_CONTRIBUICAO", "ID_TIPO_REGIME_TRIBUTARIO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT RGE_CGC_CPF AS ID,
    RGE_CGC_CPF AS cpf,
    RGE_RUC AS inscricao_estadual, 
    RGE_NOMBRE AS nome,  
    RGE_CGC_CPF AS ID_contribuinte_geral,
    CASE RGE_TIPO_CADASTRO 
        WHEN 1 THEN 'CONTRIBUINTE_ICMS'
        WHEN 2 THEN 'CONTRIBUINTE_IPVA'
        WHEN 3 THEN 'NAO_CONTRIBUINTE'
    END as ID_tipo_contribuicao, 
    CASE RGE_RUC_CONDICION
                    WHEN 0 THEN 'EXTRA_CADASTRO' 
                    WHEN 1 THEN 'CONTRIBUINTE_NORMAL'
                    WHEN 3 THEN 'PEM'
                    WHEN 4 THEN 'SUBSTITUTO_TRIBUTARIO'
                    WHEN 5 THEN 'ISENTO'
                    WHEN 7 THEN 'SIMPLES_NACIONAL'
                    WHEN 8 THEN 'SIMEI'
                    WHEN 9 THEN 'NAO_CONTRIBUINTE'
                END as ID_tipo_regime_tributario 
    FROM
    TAXMAOC.RUC_GENERAL@dl_cent geral
    WHERE ( RGE_TIPO_CADASTRO = 1 ) 
    AND RGE_TIP_PERSONA = 1
    AND (RGE_DATA_SIT_CADASTRAL, RGE_DATA_ULT_ALT) = (
        SELECT MAX(RGE_DATA_SIT_CADASTRAL) AS DATA_SITUACAO_CADASTRAL_MAX , MAX(RGE_DATA_ULT_ALT)
        FROM TAXMAOC.RUC_GENERAL@dl_cent T2
        WHERE ( RGE_TIPO_CADASTRO = 1 ) 
            AND RGE_TIP_PERSONA = 1
            AND geral.RGE_CGC_CPF = T2.RGE_CGC_CPF
    );

  CREATE INDEX "CAD_PESSOA_MAT_INDEX1" ON "CAD_PESSOA_MAT" ("INSCRICAO_ESTADUAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_PESSOA_MAT_INDEX2" ON "CAD_PESSOA_MAT" ("CPF") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_PESSOA_MAT_INDEX3" ON "CAD_PESSOA_MAT" ("NOME") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_PESSOA_MAT_INDEX4" ON "CAD_PESSOA_MAT" ("ID_CONTRIBUINTE_GERAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_PESSOA_MAT_INDEX5" ON "CAD_PESSOA_MAT" ("ID_TIPO_CONTRIBUICAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_PESSOA_MAT_INDEX6" ON "CAD_PESSOA_MAT" ("ID_TIPO_REGIME_TRIBUTARIO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_PESSOA_MAT_INDEX7" ON "CAD_PESSOA_MAT" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_PESSOA_MAT"  IS 'snapshot table for snapshot CAD_PESSOA_MAT';
--------------------------------------------------------
--  DDL for Materialized View CAD_TEM_BAIXA
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TEM_BAIXA" ("ID_SITUACAO", "ID_RAZAO_SITUACAO", "CNPJ_CPF", "DATA_SITUACAO_CADASTRAL")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 COMPRESS BASIC LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH FORCE ON DEMAND
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT CONCAT(CONCAT(CONCAT(CONCAT(CASE RGE_TSC_SIT_CADASTRAL WHEN 1 THEN 'ATIVA'
                    WHEN 2 THEN 'BAIXADA'
                    WHEN 3 THEN 'SUSPENSO'
                    WHEN 4 THEN 'CANCELADO'
                    WHEN 5 THEN 'PROCESSO_DE_BAIXA'
                    WHEN 6 THEN 'SUSPENSO_POR_OFICIO'
                    WHEN 7 THEN 'PROCESSO_DE_SUSPENSAO'                 
                    WHEN 8 THEN 'BAIXA_DE_OFICIO'
                END,'-'),RGE_RUC),'-'), TO_CHAR(RGE_DATA_SIT_CADASTRAL,'YYYY_MM_DD')) AS ID_situacao, 
                RJU_MOTIVO_BAJA AS ID_razao_situacao, 
                RGE_CGC_CPF AS cnpj_cpf, 
                RGE_DATA_SIT_CADASTRAL AS data_situacao_cadastral
    FROM TAXMAOC.RUC_JURIDICOS@DL_CENT  jur, APL_PAR.TAB_GENERICA@DL_CENT  generica, TAXMAOC.RUC_GENERAL@DL_CENT geral
    WHERE RGE_RUC = jur.RJU_RUC_JURIDICO AND ((jur.RJU_MOTIVO_BAJA = TGE_COD_TIP_TABLA) ) 
    AND TGE_TIP_TABLA = 12 AND RGE_TSC_SIT_CADASTRAL > 1
    AND  
   ( TO_CHAR(RGE_DATA_SIT_CADASTRAL, 'DD/MM/YY HH24:MI:SS'),  RGE_RUC) IN
(
SELECT DISTINCT MAX(TO_CHAR(RGE_DATA_SIT_CADASTRAL, 'DD/MM/YY HH24:MI:SS')),
RGE_RUC
FROM TAXMAOC.RUC_GENERAL@DL_CENT geral
GROUP BY RGE_RUC
);

  CREATE UNIQUE INDEX "CAD_TEM_BAIXA_INDEX1" ON "CAD_TEM_BAIXA" ("ID_SITUACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_BAIXA_INDEX2" ON "CAD_TEM_BAIXA" ("ID_RAZAO_SITUACAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_BAIXA_INDEX3" ON "CAD_TEM_BAIXA" ("CNPJ_CPF") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_BAIXA_INDEX4" ON "CAD_TEM_BAIXA" ("DATA_SITUACAO_CADASTRAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TEM_BAIXA"  IS 'snapshot table for snapshot UFC_SEM.CAD_TEM_BAIXA';
--------------------------------------------------------
--  DDL for Materialized View CAD_TEM_ATIVIDADE_ECONOMICA
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_TEM_ATIVIDADE_ECONOMICA" ("ID_ESTABELECIMENTO", "ID_ATIVIDADE_ECONOMICA", "TIPO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT 
    geral.RGE_RUC AS ID_estabelecimento, 
    RCF_TCF_CODIGO_CNAE AS ID_atividade_economica,
    CASE RCF_TIPO_CNAE WHEN '1' THEN 'PRINCIPAL' ELSE 'SECUNDARIA' END AS TIPO
    FROM 
    TAXMAOC.RUC_CNAE_FISCAL@DL_CENT , 
    TAXMAOC.RUC_GENERAL@DL_CENT geral
    WHERE 
    RCF_RGE_RUC = geral.RGE_RUC;

  CREATE INDEX "CAD_TEM_ATIVIDADE_ECONOMICA_INDEX1" ON "CAD_TEM_ATIVIDADE_ECONOMICA" ("ID_ESTABELECIMENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_ATIVIDADE_ECONOMICA_INDEX2" ON "CAD_TEM_ATIVIDADE_ECONOMICA" ("ID_ATIVIDADE_ECONOMICA") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_TEM_ATIVIDADE_ECONOMICA_INDEX3" ON "CAD_TEM_ATIVIDADE_ECONOMICA" ("TIPO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_TEM_ATIVIDADE_ECONOMICA"  IS 'snapshot table for snapshot UFC_SEM.CAD_TEM_ATIVIDADE_ECONOMICA';
--------------------------------------------------------
--  DDL for Materialized View CAD_REGISTRO_DESABILITADO
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_REGISTRO_DESABILITADO" ("ID", "INSCRICAO_ESTADUAL", "OBSERVACAO_DESABILITADO", "DATA_INICIO_DESABILITADO", "DATA_FIM_DESABILITADO", "ROTULO", "ID_USUARIO_INCLUSAO", "ID_USUARIO_EXCLUSAO")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT DISTINCT CONCAT(CONCAT(CONCAT(CONCAT(TRD_RUC,'-'),TRD_DT_INICIO),'-'),TRD_DT_FIM) AS ID , 
    TRD_RUC AS inscricao_estadual, 
    TRD_OBS AS observacao_desabilitado, 
    TRD_DT_INICIO AS data_inicio_desabilitado, 
    TRD_DT_FIM AS data_fim_desabilitado, 
    CONCAT(CONCAT(RES_NOM_ESTABLECIMIENTO,'-'),TRD_RUC) AS rotulo, 
    TRD_USR_INCLUSAO AS ID_usuario_inclusao, 
    TRD_USR_EXCLUSAO AS ID_usuario_exclusao 
    FROM TAXMAOC.RUC_DESABILITADOS@DL_CENT, TAXMAOC.RUC_ESTABLECIMIENTOS@DL_CENT 
    WHERE TRD_RUC = RES_RUC_ESTABLECIMIENTO;

  CREATE INDEX "CAD_REGISTRO_DESABILITADO_INDEX1" ON "CAD_REGISTRO_DESABILITADO" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REGISTRO_DESABILITADO_INDEX2" ON "CAD_REGISTRO_DESABILITADO" ("INSCRICAO_ESTADUAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REGISTRO_DESABILITADO_INDEX3" ON "CAD_REGISTRO_DESABILITADO" ("OBSERVACAO_DESABILITADO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REGISTRO_DESABILITADO_INDEX4" ON "CAD_REGISTRO_DESABILITADO" ("DATA_INICIO_DESABILITADO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REGISTRO_DESABILITADO_INDEX5" ON "CAD_REGISTRO_DESABILITADO" ("DATA_FIM_DESABILITADO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REGISTRO_DESABILITADO_INDEX6" ON "CAD_REGISTRO_DESABILITADO" ("ROTULO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REGISTRO_DESABILITADO_INDEX7" ON "CAD_REGISTRO_DESABILITADO" ("ID_USUARIO_INCLUSAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REGISTRO_DESABILITADO_INDEX8" ON "CAD_REGISTRO_DESABILITADO" ("ID_USUARIO_EXCLUSAO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_REGISTRO_DESABILITADO"  IS 'snapshot table for snapshot UFC_SEM.CAD_REGISTRO_DESABILITADO';
--------------------------------------------------------
--  DDL for Materialized View CAD_REPRESENTANTE_PJ
--------------------------------------------------------

  CREATE MATERIALIZED VIEW "CAD_REPRESENTANTE_PJ" ("ID", "CNPJ", "NOME", "EMAIL", "FAX", "TELEFONE")
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  BUILD IMMEDIATE
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
  REFRESH COMPLETE ON DEMAND START WITH sysdate+0 NEXT SYSDATE + 1/24
  WITH PRIMARY KEY USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT RRL_RUC_REPRESENTANTE AS ID, 
    RRL_RUC_REPRESENTANTE AS cnpj, 
    RRL_NOM_REPRESENTANTE AS NOME,
    RRL_COR_ELECTRONICO AS email, 
    CONCAT(CONCAT(RRL_DDD_FAX,'-'),RRL_FAX) AS fax, CONCAT(CONCAT(RRL_DDD_TELEFONO,'-'),RRL_TELEFONO) AS telefone
    FROM TAXMAOC.RUC_REPRESENTANTES_LEGALES@DL_CENT rep 
    WHERE LENGTH(RRL_RUC_REPRESENTANTE) > 12;

  CREATE UNIQUE INDEX "SYS_C_SNAP$_2866PK_RUC_REPRESENTANTES_LEGALES" ON "CAD_REPRESENTANTE_PJ" ("CNPJ") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE UNIQUE INDEX "CAD_REPRESENTANTE_PJ_INDEX1" ON "CAD_REPRESENTANTE_PJ" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REPRESENTANTE_PJ_INDEX3" ON "CAD_REPRESENTANTE_PJ" ("NOME") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REPRESENTANTE_PJ_INDEX4" ON "CAD_REPRESENTANTE_PJ" ("EMAIL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REPRESENTANTE_PJ_INDEX5" ON "CAD_REPRESENTANTE_PJ" ("FAX") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  CREATE INDEX "CAD_REPRESENTANTE_PJ_INDEX6" ON "CAD_REPRESENTANTE_PJ" ("TELEFONE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

   COMMENT ON MATERIALIZED VIEW "CAD_REPRESENTANTE_PJ"  IS 'snapshot table for snapshot UFC_SEM.CAD_REPRESENTANTE_PJ';
